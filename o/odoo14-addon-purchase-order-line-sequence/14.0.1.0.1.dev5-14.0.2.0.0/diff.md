# Comparing `tmp/odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5-py3-none-any.whl.zip` & `tmp/odoo14_addon_purchase_order_line_sequence-14.0.2.0.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,31 @@
-Zip file size: 30029 bytes, number of entries: 25
--rw-r--r--  2.0 unx     3337 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/README.rst
--rw-r--r--  2.0 unx      126 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/__init__.py
--rw-r--r--  2.0 unx      987 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/__manifest__.py
--rw-r--r--  2.0 unx      502 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/hooks.py
--rw-r--r--  2.0 unx     2867 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/i18n/de.po
--rw-r--r--  2.0 unx     2617 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/i18n/fr.po
--rw-r--r--  2.0 unx     2797 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot
--rw-r--r--  2.0 unx      122 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/models/__init__.py
--rw-r--r--  2.0 unx     3312 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/models/purchase.py
--rw-r--r--  2.0 unx      578 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/models/purchase_line.py
--rw-r--r--  2.0 unx      223 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      126 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      109 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/readme/ROADMAP.rst
--rw-r--r--  2.0 unx      132 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/readme/USAGE.rst
--rw-r--r--  2.0 unx     9455 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/static/description/icon.png
--rw-r--r--  2.0 unx    13256 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/static/description/index.html
--rw-r--r--  2.0 unx      108 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/tests/__init__.py
--rw-r--r--  2.0 unx     5423 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py
--rw-r--r--  2.0 unx     1457 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/views/purchase_view.xml
--rw-r--r--  2.0 unx      567 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml
--rw-r--r--  2.0 unx      577 b- defN 22-May-07 04:06 odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml
--rw-r--r--  2.0 unx     4026 b- defN 22-May-07 04:07 odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-May-07 04:07 odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-May-07 04:07 odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2950 b- defN 22-May-07 04:07 odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/RECORD
-25 files, 55751 bytes uncompressed, 24917 bytes compressed:  55.3%
+Zip file size: 33495 bytes, number of entries: 29
+-rw-r--r--  2.0 unx     3307 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/README.rst
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/__init__.py
+-rw-r--r--  2.0 unx      990 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/__manifest__.py
+-rw-r--r--  2.0 unx     2867 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/i18n/de.po
+-rw-r--r--  2.0 unx     3258 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/i18n/es.po
+-rw-r--r--  2.0 unx     2617 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/i18n/fr.po
+-rw-r--r--  2.0 unx     4267 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot
+-rw-r--r--  2.0 unx      179 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/models/__init__.py
+-rw-r--r--  2.0 unx      824 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/models/account_move_line.py
+-rw-r--r--  2.0 unx     2046 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/models/purchase.py
+-rw-r--r--  2.0 unx     1137 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/models/purchase_line.py
+-rw-r--r--  2.0 unx      547 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/models/stock_move.py
+-rw-r--r--  2.0 unx      191 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      126 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      109 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx      132 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/readme/USAGE.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/static/description/icon.png
+-rw-r--r--  2.0 unx    13228 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/static/description/index.html
+-rw-r--r--  2.0 unx      108 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/tests/__init__.py
+-rw-r--r--  2.0 unx     9956 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py
+-rw-r--r--  2.0 unx      697 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/views/account_move_view.xml
+-rw-r--r--  2.0 unx     1471 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/views/purchase_view.xml
+-rw-r--r--  2.0 unx      762 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/views/report_invoice.xml
+-rw-r--r--  2.0 unx      577 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml
+-rw-r--r--  2.0 unx      587 b- defN 23-Aug-04 06:52 odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml
+-rw-r--r--  2.0 unx     3993 b- defN 23-Aug-04 06:52 odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-04 06:52 odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Aug-04 06:52 odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3419 b- defN 23-Aug-04 06:52 odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/RECORD
+29 files, 67039 bytes uncompressed, 27591 bytes compressed:  58.8%
```

## zipnote {}

```diff
@@ -3,35 +3,41 @@
 
 Filename: odoo/addons/purchase_order_line_sequence/__init__.py
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/__manifest__.py
 Comment: 
 
-Filename: odoo/addons/purchase_order_line_sequence/hooks.py
+Filename: odoo/addons/purchase_order_line_sequence/i18n/de.po
 Comment: 
 
-Filename: odoo/addons/purchase_order_line_sequence/i18n/de.po
+Filename: odoo/addons/purchase_order_line_sequence/i18n/es.po
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/i18n/fr.po
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/models/__init__.py
 Comment: 
 
+Filename: odoo/addons/purchase_order_line_sequence/models/account_move_line.py
+Comment: 
+
 Filename: odoo/addons/purchase_order_line_sequence/models/purchase.py
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/models/purchase_line.py
 Comment: 
 
+Filename: odoo/addons/purchase_order_line_sequence/models/stock_move.py
+Comment: 
+
 Filename: odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/readme/DESCRIPTION.rst
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/readme/ROADMAP.rst
@@ -48,29 +54,35 @@
 
 Filename: odoo/addons/purchase_order_line_sequence/tests/__init__.py
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py
 Comment: 
 
+Filename: odoo/addons/purchase_order_line_sequence/views/account_move_view.xml
+Comment: 
+
 Filename: odoo/addons/purchase_order_line_sequence/views/purchase_view.xml
 Comment: 
 
+Filename: odoo/addons/purchase_order_line_sequence/views/report_invoice.xml
+Comment: 
+
 Filename: odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml
 Comment: 
 
 Filename: odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml
 Comment: 
 
-Filename: odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/METADATA
+Filename: odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/WHEEL
+Filename: odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/top_level.txt
+Filename: odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/RECORD
+Filename: odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/purchase_order_line_sequence/README.rst

```diff
@@ -60,23 +60,23 @@
 Credits
 =======
 
 Authors
 ~~~~~~~
 
 * Camptocamp
-* Eficent
+* ForgeFlow
 * Serpent CS
 
 Contributors
 ~~~~~~~~~~~~
 
 * CÃ©cile Jallais <cjallais@archeti.com>
 * Damien Crier <damien.crier@camptocamp.com>
-* Eficent Business and IT Consulting Services S.L. <contact@eficent.com>
+* ForgeFlow S.L. <contact@forgeflow.com>
 * Serpent Consulting Services Pvt. Ltd. <support@serpentcs.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
```

## odoo/addons/purchase_order_line_sequence/__init__.py

```diff
@@ -1,4 +1,3 @@
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 from . import models
-from .hooks import post_init_hook
```

## odoo/addons/purchase_order_line_sequence/__manifest__.py

```diff
@@ -1,30 +1,31 @@
 # Copyright 2017 Camptocamp SA - Damien Crier, Alexandre Fayolle
-# Copyright 2017 Eficent Business and IT Consulting Services S.L.
+# Copyright 2017 ForgeFlow S.L.
 # Copyright 2017 Serpent Consulting Services Pvt. Ltd.
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 {
     "name": "Purchase Order Line Sequence",
     "summary": "Adds sequence to PO lines and propagates it to"
     "Invoice lines and Stock Moves",
-    "version": "14.0.1.0.0",
+    "version": "14.0.2.0.0",
     "category": "Purchase Management",
     "author": "Camptocamp, "
-    "Eficent, "
+    "ForgeFlow, "
     "Serpent CS, "
     "Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/purchase-workflow",
     "depends": [
         "purchase_stock",
         "stock_picking_line_sequence",
     ],
     "data": [
         "views/purchase_view.xml",
         "views/report_purchaseorder.xml",
         "views/report_purchasequotation.xml",
+        "views/account_move_view.xml",
+        "views/report_invoice.xml",
     ],
-    "post_init_hook": "post_init_hook",
     "installable": True,
     "auto_install": False,
     "license": "AGPL-3",
 }
```

## odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot

```diff
@@ -12,62 +12,92 @@
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
 
 #. module: purchase_order_line_sequence
 #: model_terms:ir.ui.view,arch_db:purchase_order_line_sequence.report_purchase_order_sequence_qweb
 #: model_terms:ir.ui.view,arch_db:purchase_order_line_sequence.report_purchase_quote_sequence_qweb
-msgid "<strong>Sequence</strong>"
+msgid "<strong>Line Number</strong>"
 msgstr ""
 
 #. module: purchase_order_line_sequence
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_account_move_line__display_name
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order__display_name
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line__display_name
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_stock_move__display_name
 msgid "Display Name"
 msgstr ""
 
 #. module: purchase_order_line_sequence
-#: model:ir.model.fields,help:purchase_order_line_sequence.field_purchase_order_line__sequence2
+#: model:ir.model.fields,help:purchase_order_line_sequence.field_purchase_order_line__visible_sequence
 msgid "Displays the sequence of the line in the purchase order."
 msgstr ""
 
 #. module: purchase_order_line_sequence
 #: model:ir.model.fields,help:purchase_order_line_sequence.field_purchase_order_line__sequence
 msgid "Gives the sequence of the line when displaying the purchase order."
 msgstr ""
 
 #. module: purchase_order_line_sequence
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line__sequence
 msgid "Hidden Sequence"
 msgstr ""
 
 #. module: purchase_order_line_sequence
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_account_move_line__id
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order__id
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line__id
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_stock_move__id
 msgid "ID"
 msgstr ""
 
 #. module: purchase_order_line_sequence
+#: model:ir.model,name:purchase_order_line_sequence.model_account_move_line
+msgid "Journal Item"
+msgstr ""
+
+#. module: purchase_order_line_sequence
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_account_move_line____last_update
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order____last_update
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line____last_update
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_stock_move____last_update
 msgid "Last Modified on"
 msgstr ""
 
 #. module: purchase_order_line_sequence
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line__visible_sequence
+#: model_terms:ir.ui.view,arch_db:purchase_order_line_sequence.report_invoice_document_inherit_purchase_sequence
+msgid "Line Number"
+msgstr ""
+
+#. module: purchase_order_line_sequence
 #: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order__max_line_sequence
 msgid "Max sequence in lines"
 msgstr ""
 
 #. module: purchase_order_line_sequence
+#: code:addons/purchase_order_line_sequence/models/stock_move.py:0
+#, python-format
+msgid ""
+"Not allowed to change the sequence of moves from the picking, you can do it "
+"from the PO."
+msgstr ""
+
+#. module: purchase_order_line_sequence
+#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_account_move_line__related_po_sequence
+msgid "PO Line Number"
+msgstr ""
+
+#. module: purchase_order_line_sequence
 #: model:ir.model,name:purchase_order_line_sequence.model_purchase_order
 msgid "Purchase Order"
 msgstr ""
 
 #. module: purchase_order_line_sequence
 #: model:ir.model,name:purchase_order_line_sequence.model_purchase_order_line
 msgid "Purchase Order Line"
 msgstr ""
 
 #. module: purchase_order_line_sequence
-#: model:ir.model.fields,field_description:purchase_order_line_sequence.field_purchase_order_line__sequence2
-msgid "Sequence"
+#: model:ir.model,name:purchase_order_line_sequence.model_stock_move
+msgid "Stock Move"
 msgstr ""
```

## odoo/addons/purchase_order_line_sequence/models/__init__.py

```diff
@@ -1,4 +1,6 @@
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 from . import purchase
 from . import purchase_line
+from . import account_move_line
+from . import stock_move
```

## odoo/addons/purchase_order_line_sequence/models/purchase.py

```diff
@@ -1,9 +1,9 @@
 # Copyright 2017 Camptocamp SA - Damien Crier, Alexandre Fayolle
-# Copyright 2017 Eficent Business and IT Consulting Services S.L.
+# Copyright 2017 ForgeFlow S.L.
 # Copyright 2017 Serpent Consulting Services Pvt. Ltd.
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 from odoo import api, fields, models
 
 
 class PurchaseOrder(models.Model):
@@ -23,73 +23,35 @@
 
     max_line_sequence = fields.Integer(
         string="Max sequence in lines", compute="_compute_max_line_sequence"
     )
 
     def _create_picking(self):
         res = super(PurchaseOrder, self)._create_picking()
+        self._update_moves_sequence()
+        return res
+
+    def _update_moves_sequence(self):
         for order in self:
             if any(
                 [
                     ptype in ["product", "consu"]
                     for ptype in order.order_line.mapped("product_id.type")
                 ]
             ):
-                pickings = order.picking_ids.filtered(
-                    lambda x: x.state not in ("done", "cancel")
-                )
-                if pickings:
-                    picking = pickings[0]
-                    for move, line in zip(
-                        sorted(picking.move_lines, key=lambda m: m.id), order.order_line
-                    ):
-                        move.write({"sequence": line.sequence})
-        return res
+                for picking in order.picking_ids:
+                    for move in picking.move_lines:
+                        if not move.purchase_line_id:
+                            continue
+                        move.write({"sequence": move.purchase_line_id.visible_sequence})
 
-    def _reset_sequence(self):
-        for rec in self:
-            current_sequence = 1
-            for line in rec.order_line:
-                line.sequence = current_sequence
-                current_sequence += 1
+    @api.model
+    def create(self, vals):
+        res = super(PurchaseOrder, self).create(vals)
+        self._update_moves_sequence()
+        return res
 
     def write(self, line_values):
         res = super(PurchaseOrder, self).write(line_values)
-        self._reset_sequence()
+        if "order_line" in line_values:
+            self._update_moves_sequence()
         return res
-
-    def copy(self, default=None):
-        return super(PurchaseOrder, self.with_context(keep_line_sequence=True)).copy(
-            default
-        )
-
-
-class PurchaseOrderLine(models.Model):
-    _inherit = "purchase.order.line"
-    _order = "sequence, id"
-
-    sequence = fields.Integer(
-        "Hidden Sequence",
-        help="Gives the sequence of the line when " "displaying the purchase order.",
-        default=9999,
-    )
-
-    sequence2 = fields.Integer(
-        "Sequence",
-        help="Displays the sequence of the line in " "the purchase order.",
-        related="sequence",
-        readonly=True,
-    )
-
-    def _prepare_stock_moves(self, picking):
-        res = super(PurchaseOrderLine, self)._prepare_stock_moves(picking)
-        for move, line in zip(res, self):
-            move.update(sequence=line.sequence)
-        return res
-
-    @api.model
-    def create(self, values):
-        line = super(PurchaseOrderLine, self).create(values)
-        # We do not reset the sequence when copying an entire purchase order
-        if not self.env.context.get("keep_line_sequence"):
-            line.order_id._reset_sequence()
-        return line
```

## odoo/addons/purchase_order_line_sequence/models/purchase_line.py

```diff
@@ -1,17 +1,33 @@
 # Copyright 2017 Camptocamp SA - Damien Crier, Alexandre Fayolle
-# Copyright 2017 Eficent Business and IT Consulting Services S.L.
+# Copyright 2017 ForgeFlow S.L.
 # Copyright 2017 Serpent Consulting Services Pvt. Ltd.
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
-from odoo import models
+from odoo import api, fields, models
 
 
 class PurchaseOrderLine(models.Model):
     _inherit = "purchase.order.line"
+    _order = "sequence, id"
 
-    def _prepare_account_move_line(self, move=False):
-        self.ensure_one()
-        res = super(PurchaseOrderLine, self)._prepare_account_move_line(move)
-        res["sequence"] = self.sequence
+    sequence = fields.Integer(
+        "Hidden Sequence",
+        help="Gives the sequence of the line when " "displaying the purchase order.",
+        default=9999,
+    )
 
-        return res
+    visible_sequence = fields.Integer(
+        "Line Number",
+        help="Displays the sequence of the line in the purchase order.",
+        compute="_compute_visible_sequence",
+        store=True,
+    )
+
+    @api.depends("sequence", "order_id.order_line")
+    def _compute_visible_sequence(self):
+        for po in self.mapped("order_id"):
+            sequence = 1
+            order_lines = po.order_line.filtered(lambda l: not l.display_type)
+            for line in sorted(order_lines, key=lambda l: l.sequence):
+                line.visible_sequence = sequence
+                sequence += 1
```

## odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst

```diff
@@ -1,4 +1,4 @@
 * CÃ©cile Jallais <cjallais@archeti.com>
 * Damien Crier <damien.crier@camptocamp.com>
-* Eficent Business and IT Consulting Services S.L. <contact@eficent.com>
+* ForgeFlow S.L. <contact@forgeflow.com>
 * Serpent Consulting Services Pvt. Ltd. <support@serpentcs.com>
```

## odoo/addons/purchase_order_line_sequence/static/description/index.html

### odoo/addons/purchase_order_line_sequence/static/description/index.html

```diff
@@ -457,15 +457,15 @@
         </h1>
         <div class="section" id="authors">
           <h2>
             <a class="toc-backref" href="#id5">Authors</a>
           </h2>
           <ul class="simple">
             <li>Camptocamp</li>
-            <li>Eficent</li>
+            <li>ForgeFlow</li>
             <li>Serpent CS</li>
           </ul>
         </div>
         <div class="section" id="contributors">
           <h2>
             <a class="toc-backref" href="#id6">Contributors</a>
           </h2>
@@ -477,16 +477,16 @@
             </li>
             <li>
               Damien Crier &lt;
               <a class="reference external" href="mailto:damien.crier@camptocamp.com">damien.crier@camptocamp.com</a>
               &gt;
             </li>
             <li>
-              Eficent Business and IT Consulting Services S.L. &lt;
-              <a class="reference external" href="mailto:contact@eficent.com">contact@eficent.com</a>
+              ForgeFlow S.L. &lt;
+              <a class="reference external" href="mailto:contact@forgeflow.com">contact@forgeflow.com</a>
               &gt;
             </li>
             <li>
               Serpent Consulting Services Pvt. Ltd. &lt;
               <a class="reference external" href="mailto:support@serpentcs.com">support@serpentcs.com</a>
               &gt;
             </li>
```

## odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py

```diff
@@ -1,18 +1,19 @@
 # Copyright 2017 Camptocamp SA - Damien Crier, Alexandre Fayolle
 # Copyright 2017 Eficent Business and IT Consulting Services S.L.
 # Copyright 2017 Serpent Consulting Services Pvt. Ltd.
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 from datetime import datetime
 
-from odoo.tests import common
+from odoo.tests import common, tagged
 from odoo.tools import DEFAULT_SERVER_DATETIME_FORMAT
 
 
+@tagged("post_install", "-at_install")
 class TestPurchaseOrder(common.TransactionCase):
     def setUp(self):
         super(TestPurchaseOrder, self).setUp()
         # Useful models
         self.PurchaseOrder = self.env["purchase.order"]
         self.PurchaseOrderLine = self.env["purchase.order.line"]
         self.partner_id = self.env.ref("base.res_partner_1")
@@ -105,48 +106,169 @@
             [("purchase_line_id", "=", self.po.order_line[0].id)]
         )
         move2 = self.env["stock.move"].search(
             [("purchase_line_id", "=", self.po.order_line[1].id)]
         )
 
         self.assertEqual(
-            self.po.order_line[0].sequence,
+            self.po.order_line[0].visible_sequence,
             move1.sequence,
             "The Sequence of the Purchase Order Lines does not "
             "match to the Stock Moves",
         )
         self.assertEqual(
-            self.po.order_line[1].sequence,
+            self.po.order_line[1].visible_sequence,
             move2.sequence,
             "The Sequence of the Purchase Order Lines does not "
             "match to the Stock Moves",
         )
 
         self.po2 = self.po.copy()
         self.assertEqual(
-            self.po.order_line[0].sequence,
-            self.po2.order_line[0].sequence,
+            self.po.order_line[0].visible_sequence,
+            self.po2.order_line[0].visible_sequence,
             "The Sequence is not copied properly",
         )
         self.assertEqual(
-            self.po.order_line[1].sequence,
-            self.po2.order_line[1].sequence,
+            self.po.order_line[1].visible_sequence,
+            self.po2.order_line[1].visible_sequence,
             "The Sequence is not copied properly",
         )
 
-    def test_invoice_sequence(self):
+    def test_purchase_order_line_sequence_with_section_note(self):
+        """
+        Verify that the sequence is correctly assigned to the move associated
+        with the purchase order line it references.
+        """
+        po = self._create_purchase_order()
+        self.PurchaseOrderLine.create(
+            {
+                "name": "Section 1",
+                "display_type": "line_section",
+                "order_id": po.id,
+                "product_qty": 0,
+            }
+        )
+        self.PurchaseOrderLine.create(
+            {
+                "name": self.product_id_1.name,
+                "product_id": self.product_id_1.id,
+                "product_qty": 15.0,
+                "product_uom": self.product_id_1.uom_po_id.id,
+                "price_unit": 150.0,
+                "date_planned": datetime.today().strftime(
+                    DEFAULT_SERVER_DATETIME_FORMAT
+                ),
+                "order_id": po.id,
+            }
+        )
+        self.PurchaseOrderLine.create(
+            {
+                "name": "Note 1",
+                "display_type": "line_note",
+                "order_id": po.id,
+                "product_qty": 0,
+            }
+        )
+        self.PurchaseOrderLine.create(
+            {
+                "name": self.product_id_2.name,
+                "product_id": self.product_id_2.id,
+                "product_qty": 1.0,
+                "product_uom": self.product_id_2.uom_po_id.id,
+                "price_unit": 50.0,
+                "date_planned": datetime.today().strftime(
+                    DEFAULT_SERVER_DATETIME_FORMAT
+                ),
+                "order_id": po.id,
+            }
+        )
+        po.button_confirm()
+
+        moves = po.picking_ids[0].move_ids_without_package
+        self.assertNotEquals(len(po.order_line), len(moves))
+
+        for move in moves:
+            self.assertEqual(move.sequence, move.purchase_line_id.visible_sequence)
+
+    def test_write_purchase_order_line(self):
+        """
+        Verify that the sequence is correctly assigned to the move associated
+        with the purchase order line it references when you modify it.
+        """
+        po = self._create_purchase_order()
+        po.button_confirm()
+
+        po.write(
+            {
+                "order_line": [
+                    (
+                        0,
+                        0,
+                        {
+                            "name": self.product_id_2.name,
+                            "product_id": self.product_id_2.id,
+                            "product_qty": 2,
+                            "product_uom": self.product_id_2.uom_id.id,
+                            "price_unit": 30,
+                            "date_planned": datetime.today().strftime(
+                                DEFAULT_SERVER_DATETIME_FORMAT
+                            ),
+                        },
+                    )
+                ]
+            }
+        )
+
+        moves = po.picking_ids[0].move_ids_without_package
+        for move in moves:
+            self.assertEqual(move.sequence, move.purchase_line_id.visible_sequence)
 
+    def test_invoice_sequence(self):
+        """
+        Verify that the sequence is correctly assigned to the account move associated
+        with the purchase order line it references.
+        """
         po = self._create_purchase_order()
         po.button_confirm()
         po.order_line.qty_received = 5
         result = po.action_create_invoice()
         self.invoice = self.AccountInvoice.browse(result["res_id"])
         self.assertEqual(
-            po.order_line[0].sequence,
-            self.invoice.line_ids[0].sequence,
-            "The Sequence is not copied properly",
+            str(po.order_line[0].visible_sequence),
+            self.invoice.line_ids[0].related_po_sequence,
         )
         self.assertEqual(
-            po.order_line[1].sequence,
-            self.invoice.line_ids[1].sequence,
-            "The Sequence is not copied properly",
+            str(po.order_line[1].visible_sequence),
+            self.invoice.line_ids[1].related_po_sequence,
+        )
+
+    def test_invoice_multiple_orders_sequence(self):
+        """
+        Verify that the sequence is correctly assigned to the account move associated
+        with the purchase order line it references,
+        when adding different POs to the same invoice.
+        Format expected:
+        - PO12345/1  -  PO Name + "/" + Sequence
+        """
+        po = self._create_purchase_order()
+        po.button_confirm()
+        po.order_line.qty_received = 5
+        po2 = self._create_purchase_order()
+        po2.button_confirm()
+        po2.order_line.qty_received = 2
+
+        orders = self.PurchaseOrder.search([("id", "in", [po.id, po2.id])])
+        result = orders.action_create_invoice()
+        invoice = self.AccountInvoice.search([("id", "=", result["res_id"])], limit=1)
+
+        self.assertTrue(invoice)
+        self.assertTrue(len(invoice.invoice_origin.split(",")), 2)
+
+        self.assertEqual(
+            invoice.invoice_line_ids[0].related_po_sequence,
+            "{}/{}".format(po2.name, po2.order_line[0].visible_sequence),
+        )
+        self.assertEqual(
+            invoice.invoice_line_ids[3].related_po_sequence,
+            "{}/{}".format(po.name, po.order_line[1].visible_sequence),
         )
```

## odoo/addons/purchase_order_line_sequence/views/purchase_view.xml

### odoo/addons/purchase_order_line_sequence/views/purchase_view.xml

```diff
@@ -2,15 +2,15 @@
 <odoo>
   <record model="ir.ui.view" id="purchase_order_line_form">
     <field name="name">purchase.order.line.form</field>
     <field name="model">purchase.order.line</field>
     <field name="inherit_id" ref="purchase.purchase_order_line_form2"/>
     <field name="arch" type="xml">
       <field name="company_id" position="after">
-        <field name="sequence2"/>
+        <field name="visible_sequence"/>
       </field>
     </field>
   </record>
   <record id="purchase_order_form" model="ir.ui.view">
     <field name="name">purchase.order.form</field>
     <field name="model">purchase.order</field>
     <field name="inherit_id" ref="purchase.purchase_order_form"/>
@@ -20,12 +20,12 @@
         <field name="max_line_sequence" invisible="1"/>
       </xpath>
       <xpath expr="//field[@name='order_line']" position="attributes">
         <attribute name="context">{'default_sequence':
                     max_line_sequence, 'default_state': 'draft'}</attribute>
       </xpath>
       <xpath expr="//field[@name='order_line']/tree/field[@name='product_id']" position="before">
-        <field name="sequence2"/>
+        <field name="visible_sequence"/>
       </xpath>
     </field>
   </record>
 </odoo>
```

## odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml

### odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml

```diff
@@ -1,16 +1,16 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <template id="report_purchase_order_sequence_qweb" inherit_id="purchase.report_purchaseorder_document">
     <xpath expr="//table/thead/tr/th[1]" position="before">
       <th>
-        <strong>Sequence</strong>
+        <strong>Line Number</strong>
       </th>
     </xpath>
     <!--complicated expr to be compatible with other modules-->
     <xpath expr="//table/tbody//span[1]/.." position="before">
       <td>
-        <span t-field="line.sequence2"/>
+        <span t-field="line.visible_sequence"/>
       </td>
     </xpath>
   </template>
 </odoo>
```

## odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml

### odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml

```diff
@@ -1,16 +1,16 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <template id="report_purchase_quote_sequence_qweb" inherit_id="purchase.report_purchasequotation_document">
     <xpath expr="//table/thead/tr/th[1]" position="before">
       <th>
-        <strong>Sequence</strong>
+        <strong>Line Number</strong>
       </th>
     </xpath>
     <!--complicated expr to be compatible with other modules-->
     <xpath expr="//table/tbody//span[1]/.." position="before">
       <td>
-        <span t-field="order_line.sequence2"/>
+        <span t-field="order_line.visible_sequence"/>
       </td>
     </xpath>
   </template>
 </odoo>
```

## Comparing `odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/METADATA` & `odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/METADATA`

 * *Files 6% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-purchase-order-line-sequence
-Version: 14.0.1.0.1.dev5
+Version: 14.0.2.0.0
 Summary: Adds sequence to PO lines and propagates it toInvoice lines and Stock Moves
 Home-page: https://github.com/OCA/purchase-workflow
-Author: Camptocamp, Eficent, Serpent CS, Odoo Community Association (OCA)
+Author: Camptocamp, ForgeFlow, Serpent CS, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
 Classifier: Framework :: Odoo :: 14.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
@@ -77,23 +77,23 @@
 Credits
 =======
 
 Authors
 ~~~~~~~
 
 * Camptocamp
-* Eficent
+* ForgeFlow
 * Serpent CS
 
 Contributors
 ~~~~~~~~~~~~
 
 * CÃ©cile Jallais <cjallais@archeti.com>
 * Damien Crier <damien.crier@camptocamp.com>
-* Eficent Business and IT Consulting Services S.L. <contact@eficent.com>
+* ForgeFlow S.L. <contact@forgeflow.com>
 * Serpent Consulting Services Pvt. Ltd. <support@serpentcs.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
```

## Comparing `odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/RECORD` & `odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,25 +1,29 @@
-odoo/addons/purchase_order_line_sequence/README.rst,sha256=EHhRLe3jr9CoTgsv_F-8Z0oUzw26s6c3jeiDtkWacKI,3337
-odoo/addons/purchase_order_line_sequence/__init__.py,sha256=6CGLNMVZ--55FOPBhnKu8w7kW6vI0d0VoZ2uqINXyNU,126
-odoo/addons/purchase_order_line_sequence/__manifest__.py,sha256=qrJBxr2yagbir3KiBpkz2D-ZsL5hyplCjQ3aXJHXqSc,987
-odoo/addons/purchase_order_line_sequence/hooks.py,sha256=hb-dJ57DvgjUHEhHbnp1m732lwAUzBsgghVl0-BWv5o,502
+odoo/addons/purchase_order_line_sequence/README.rst,sha256=CfyroGR0WZTCCx5JakRS_qiwaxjnmAQYgLTPQ_7YyDQ,3307
+odoo/addons/purchase_order_line_sequence/__init__.py,sha256=QXl_U5mKDJfzIWJDZpUzH9Rf4Zda8Ko8Q1Df6Lc0MF8,92
+odoo/addons/purchase_order_line_sequence/__manifest__.py,sha256=B15_wbJipathrzyFhyUpZQIcU5HENf9H0HMpYaVBDCQ,990
 odoo/addons/purchase_order_line_sequence/i18n/de.po,sha256=xbA5-hPGWDLzsWCLrtmEs4e5axM0zkn1F_4_pG5T6dU,2867
+odoo/addons/purchase_order_line_sequence/i18n/es.po,sha256=jC7hk7ZR44eSaRb2DrR7NttB0VCup7U7oAQf5_pHCZ4,3258
 odoo/addons/purchase_order_line_sequence/i18n/fr.po,sha256=5UAIZBS8BiA76R7tvFYdmEe4_WQ9Bf9GkQGHn7ofc50,2617
-odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot,sha256=kweqyAOx81x2fuIzwG3xIgb3AQnR8wEe55oOkI_CI9k,2797
-odoo/addons/purchase_order_line_sequence/models/__init__.py,sha256=5BKEbTiLWlwpe97I5w6FBE4yYESFTRV-IlK6vnv8aS0,122
-odoo/addons/purchase_order_line_sequence/models/purchase.py,sha256=XQos3jFSTraLtI3h7KBQ0Yc3px5Xw3obwnq3HQ7W-0M,3312
-odoo/addons/purchase_order_line_sequence/models/purchase_line.py,sha256=2-jw2kwltRZefV1OmtqDSiK4d2R4Wjq_IKhsSjtr8JA,578
-odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst,sha256=jkzIAPazM6TAbBJw0i13bCSU99RMdqnmW_3Bb81oUf4,223
+odoo/addons/purchase_order_line_sequence/i18n/purchase_order_line_sequence.pot,sha256=_szXaC3LfjI1iq92z-qdDPqulHtNTCIvPahZiEDsQ1c,4267
+odoo/addons/purchase_order_line_sequence/models/__init__.py,sha256=fcXNyPyTWUNNM1O6BOiecbJ4SukQeTfqE0FxIjbp8Ys,179
+odoo/addons/purchase_order_line_sequence/models/account_move_line.py,sha256=w-7Zjnk2za2sVJnq1ceaT3pwS8p7jHrmJF8Ey7Dx8Ys,824
+odoo/addons/purchase_order_line_sequence/models/purchase.py,sha256=POZrStHqx_Q2c6imXh_wHHgYpHRLK0OErjC-nkQbt4M,2046
+odoo/addons/purchase_order_line_sequence/models/purchase_line.py,sha256=FsxIoGI0dIsDLfekNCQZ4bfYO29yV9xumRVvdhZsm4k,1137
+odoo/addons/purchase_order_line_sequence/models/stock_move.py,sha256=cwsKq8r9k07BkqUECeZHwD5SbkuYwKaPLmsQTv2Xf3g,547
+odoo/addons/purchase_order_line_sequence/readme/CONTRIBUTORS.rst,sha256=cCuRqQkPSF2iDLyRiwWnuOmFws9r6DA-YfcBRKFGAZ0,191
 odoo/addons/purchase_order_line_sequence/readme/DESCRIPTION.rst,sha256=OQ9ZnOMX2YiTMN-s9tAF49gA2HF5Qh0lqvfYWbgFxfs,126
 odoo/addons/purchase_order_line_sequence/readme/ROADMAP.rst,sha256=36K1IMpw2bFDGWj98uBE7-1ndBOn1MMp1Wn0i3zqqKM,109
 odoo/addons/purchase_order_line_sequence/readme/USAGE.rst,sha256=1jCEKQGw0lFm_pEhe6sMtO17gVSXCEKMFFL7wCdvQ_E,132
 odoo/addons/purchase_order_line_sequence/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/purchase_order_line_sequence/static/description/index.html,sha256=68uLG3Y7uDxf7yWOMdGcobGW4CkX0fbu0E8lqc5By4w,13256
+odoo/addons/purchase_order_line_sequence/static/description/index.html,sha256=yg4TxyGYy9cKt1WT0gXg7FnfA3V5YhRnl6Z2D05cz9E,13228
 odoo/addons/purchase_order_line_sequence/tests/__init__.py,sha256=W0mPdVpuku71ToHFkfAY7tzd8IBAhOVZWteW5yzJCKo,108
-odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py,sha256=CDWtKcPfE-qKhNtBhIoaU5wA48DloD5fbeahFvnhS4g,5423
-odoo/addons/purchase_order_line_sequence/views/purchase_view.xml,sha256=tHymEAMD_vyY5irlGJ-s21zSp-lMpAg7utE89HpuuMk,1457
-odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml,sha256=f6VmChUOcz7as08J0dnWsweWqHMyY7AJsztsti8NpsE,567
-odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml,sha256=ihdV1QjM3G7HqN9QUZEXHG0Vp3UY_5gQYWfuC1Pi7AE,577
-odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/METADATA,sha256=kmFM_zzaF6k3-lETkssFkv4oTw5OvpWTzGF06OnmzBw,4026
-odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_purchase_order_line_sequence-14.0.1.0.1.dev5.dist-info/RECORD,,
+odoo/addons/purchase_order_line_sequence/tests/test_po_lines_sequence.py,sha256=5pTZq25OdjyBf2e_A27P6oGRNUdWlZ7YgBnpziVLkok,9956
+odoo/addons/purchase_order_line_sequence/views/account_move_view.xml,sha256=o9gDEjYjtMV0BuCjogTf0kAQHuCkwyZd8ULtGFKdgTY,697
+odoo/addons/purchase_order_line_sequence/views/purchase_view.xml,sha256=nrOz9iJCDhqbml_H6wIdZ6jMefmm9WS4JSZ3W9i2a6g,1471
+odoo/addons/purchase_order_line_sequence/views/report_invoice.xml,sha256=e3yUyQaR6m_x_2bBcBsfIpiuP1QHbE0QSUnQaEPNp0w,762
+odoo/addons/purchase_order_line_sequence/views/report_purchaseorder.xml,sha256=HJjbH2tK7pF-vZgT3Yc6ReYTonNu0ipmzuf9sOf86y0,577
+odoo/addons/purchase_order_line_sequence/views/report_purchasequotation.xml,sha256=y8d5kKkB95uNHHEuYbw_BSUasNtgY76TkDSt8m__nt0,587
+odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/METADATA,sha256=azccfE8Ksebr-ds3mcNIzNhiT_SkAUnuSb5eNoCdMmY,3993
+odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
+odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_purchase_order_line_sequence-14.0.2.0.0.dist-info/RECORD,,
```

