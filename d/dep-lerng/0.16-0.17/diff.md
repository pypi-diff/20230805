# Comparing `tmp/dep_lerng-0.16.tar.gz` & `tmp/dep_lerng-0.17.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dep_lerng-0.16.tar", last modified: Sat Aug  5 00:06:16 2023, max compression
+gzip compressed data, was "dep_lerng-0.17.tar", last modified: Sat Aug  5 00:10:19 2023, max compression
```

## Comparing `dep_lerng-0.16.tar` & `dep_lerng-0.17.tar`

### file list

```diff
@@ -1,19 +1,19 @@
-drwxrwxrwx   0        0        0        0 2023-08-05 00:06:16.052785 dep_lerng-0.16/
--rw-rw-rw-   0        0        0      211 2023-08-05 00:06:16.052785 dep_lerng-0.16/PKG-INFO
-drwxrwxrwx   0        0        0        0 2023-08-05 00:06:16.048785 dep_lerng-0.16/dep_lerng/
--rw-rw-rw-   0        0        0     3666 2023-08-04 23:22:08.000000 dep_lerng-0.16/dep_lerng/ClassifierNet.py
--rw-rw-rw-   0        0        0     3101 2023-08-04 23:22:09.000000 dep_lerng-0.16/dep_lerng/ConvBlock.py
--rw-rw-rw-   0        0        0     1268 2023-08-04 23:22:10.000000 dep_lerng-0.16/dep_lerng/Dataset.py
--rw-rw-rw-   0        0        0     7116 2023-08-04 23:22:09.000000 dep_lerng-0.16/dep_lerng/ResBlock.py
--rw-rw-rw-   0        0        0     7822 2023-08-05 00:05:31.000000 dep_lerng-0.16/dep_lerng/ResNet.py
--rw-rw-rw-   0        0        0       75 2023-08-04 23:22:07.000000 dep_lerng-0.16/dep_lerng/__init__.py
--rw-rw-rw-   0        0        0    10166 2023-08-04 23:22:08.000000 dep_lerng-0.16/dep_lerng/custom_blocks.py
--rw-rw-rw-   0        0        0     9602 2023-08-05 00:00:37.000000 dep_lerng-0.16/dep_lerng/model_init.py
-drwxrwxrwx   0        0        0        0 2023-08-05 00:06:16.051785 dep_lerng-0.16/dep_lerng.egg-info/
--rw-rw-rw-   0        0        0      211 2023-08-05 00:06:16.000000 dep_lerng-0.16/dep_lerng.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      358 2023-08-05 00:06:16.000000 dep_lerng-0.16/dep_lerng.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-08-05 00:06:16.000000 dep_lerng-0.16/dep_lerng.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-08-05 00:00:57.000000 dep_lerng-0.16/dep_lerng.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       10 2023-08-05 00:06:16.000000 dep_lerng-0.16/dep_lerng.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-08-05 00:06:16.052785 dep_lerng-0.16/setup.cfg
--rw-rw-rw-   0        0        0      276 2023-08-05 00:06:07.000000 dep_lerng-0.16/setup.py
+drwxrwxrwx   0        0        0        0 2023-08-05 00:10:19.378636 dep_lerng-0.17/
+-rw-rw-rw-   0        0        0      211 2023-08-05 00:10:19.378636 dep_lerng-0.17/PKG-INFO
+drwxrwxrwx   0        0        0        0 2023-08-05 00:10:19.373637 dep_lerng-0.17/dep_lerng/
+-rw-rw-rw-   0        0        0     3667 2023-08-05 00:10:03.000000 dep_lerng-0.17/dep_lerng/ClassifierNet.py
+-rw-rw-rw-   0        0        0     3101 2023-08-04 23:22:09.000000 dep_lerng-0.17/dep_lerng/ConvBlock.py
+-rw-rw-rw-   0        0        0     1268 2023-08-04 23:22:10.000000 dep_lerng-0.17/dep_lerng/Dataset.py
+-rw-rw-rw-   0        0        0     7117 2023-08-05 00:10:04.000000 dep_lerng-0.17/dep_lerng/ResBlock.py
+-rw-rw-rw-   0        0        0     7822 2023-08-05 00:05:31.000000 dep_lerng-0.17/dep_lerng/ResNet.py
+-rw-rw-rw-   0        0        0       75 2023-08-04 23:22:07.000000 dep_lerng-0.17/dep_lerng/__init__.py
+-rw-rw-rw-   0        0        0    10166 2023-08-04 23:22:08.000000 dep_lerng-0.17/dep_lerng/custom_blocks.py
+-rw-rw-rw-   0        0        0     9602 2023-08-05 00:00:37.000000 dep_lerng-0.17/dep_lerng/model_init.py
+drwxrwxrwx   0        0        0        0 2023-08-05 00:10:19.377637 dep_lerng-0.17/dep_lerng.egg-info/
+-rw-rw-rw-   0        0        0      211 2023-08-05 00:10:19.000000 dep_lerng-0.17/dep_lerng.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      358 2023-08-05 00:10:19.000000 dep_lerng-0.17/dep_lerng.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-08-05 00:10:19.000000 dep_lerng-0.17/dep_lerng.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-08-05 00:00:57.000000 dep_lerng-0.17/dep_lerng.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       10 2023-08-05 00:10:19.000000 dep_lerng-0.17/dep_lerng.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-08-05 00:10:19.378636 dep_lerng-0.17/setup.cfg
+-rw-rw-rw-   0        0        0      276 2023-08-05 00:10:10.000000 dep_lerng-0.17/setup.py
```

### Comparing `dep_lerng-0.16/dep_lerng/ClassifierNet.py` & `dep_lerng-0.17/dep_lerng/ClassifierNet.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,15 +2,15 @@
 from torch.nn import Module, Conv2d, Linear, MaxPool2d, AvgPool2d, Sequential, Dropout2d, Dropout, AdaptiveAvgPool2d, LazyConv2d, AlphaDropout, Bilinear
 from torch.nn import BatchNorm1d, BatchNorm2d, GroupNorm, LazyLinear, LazyBatchNorm1d, LogSoftmax, MultiheadAttention
 from torch.nn import Mish, ReLU, LeakyReLU, PReLU, SELU, Tanh, Sigmoid, ELU, Flatten, Softmax
 from torch import flatten, unsqueeze
 
 import torch
 
-from custom_blocks import AFF,MSCAM, SAM, iAFF, ECA
+from .custom_blocks import AFF,MSCAM, SAM, iAFF, ECA
 
 torch.manual_seed(43)
   
 # torch.set_float32_matmul_precision("high")
 
 acti = Mish(inplace = True)
 # acti = PReLU()
```

### Comparing `dep_lerng-0.16/dep_lerng/ConvBlock.py` & `dep_lerng-0.17/dep_lerng/ConvBlock.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.16/dep_lerng/Dataset.py` & `dep_lerng-0.17/dep_lerng/Dataset.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.16/dep_lerng/ResBlock.py` & `dep_lerng-0.17/dep_lerng/ResBlock.py`

 * *Files 0% similar despite different names*

```diff
@@ -21,425 +21,425 @@
 00000140: 746f 7263 6820 696d 706f 7274 206d 756c  torch import mul
 00000150: 0d0a 0d0a 6672 6f6d 2074 6f72 6368 7669  ....from torchvi
 00000160: 7369 6f6e 2e6f 7073 2069 6d70 6f72 7420  sion.ops import 
 00000170: 4472 6f70 426c 6f63 6b32 640d 0a0d 0a66  DropBlock2d....f
 00000180: 726f 6d20 6b6f 726e 6961 2e61 7567 6d65  rom kornia.augme
 00000190: 6e74 6174 696f 6e20 696d 706f 7274 2052  ntation import R
 000001a0: 6573 697a 650d 0a69 6d70 6f72 7420 746f  esize..import to
-000001b0: 7263 680d 0a0d 0a66 726f 6d20 6375 7374  rch....from cust
-000001c0: 6f6d 5f62 6c6f 636b 7320 696d 706f 7274  om_blocks import
-000001d0: 2041 4646 2c4d 5343 414d 2c20 5341 4d2c   AFF,MSCAM, SAM,
-000001e0: 2069 4146 462c 2045 4341 0d0a 0d0a 746f   iAFF, ECA....to
-000001f0: 7263 682e 6d61 6e75 616c 5f73 6565 6428  rch.manual_seed(
-00000200: 3433 290d 0a0d 0a61 6374 6920 3d20 4d69  43)....acti = Mi
-00000210: 7368 2869 6e70 6c61 6365 203d 2054 7275  sh(inplace = Tru
-00000220: 6529 0d0a 2320 6163 7469 203d 2050 5265  e)..# acti = PRe
-00000230: 4c55 2829 0d0a 0d0a 2320 746f 7263 682e  LU()....# torch.
-00000240: 7365 745f 666c 6f61 7433 325f 6d61 746d  set_float32_matm
-00000250: 756c 5f70 7265 6369 7369 6f6e 2822 6869  ul_precision("hi
-00000260: 6768 2229 0d0a 0d0a 6465 6620 5265 7342  gh")....def ResB
-00000270: 6c6f 636b 286d 6f64 6966 6965 7273 2c20  lock(modifiers, 
-00000280: 7371 7565 657a 652c 2061 7567 6d65 6e74  squeeze, augment
-00000290: 2c20 6c61 7965 7220 3d20 4e6f 6e65 293a  , layer = None):
-000002a0: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-000002b0: 2056 616e 696c 6c61 2042 6c6f 636b 203a   Vanilla Block :
-000002c0: 204f 7269 6769 6e61 6c20 5265 7369 6475   Original Residu
-000002d0: 616c 2042 6c6f 636b 2061 7320 6d65 6e74  al Block as ment
-000002e0: 696f 6e65 6420 696e 2031 3531 322e 3033  ioned in 1512.03
-000002f0: 3338 3520 5b44 6565 7020 5265 7369 6475  385 [Deep Residu
-00000300: 616c 204c 6561 726e 696e 6720 666f 7220  al Learning for 
-00000310: 496d 6167 6520 5265 636f 676e 6974 696f  Image Recognitio
-00000320: 6e5d 0d0a 0d0a 2020 2020 426f 7474 6c65  n]....    Bottle
-00000330: 6e65 636b 2042 6c6f 636b 203a 204f 7269  neck Block : Ori
-00000340: 6769 6e61 6c20 426f 7474 6c65 6e65 636b  ginal Bottleneck
-00000350: 2042 6c6f 636b 2061 7320 6d65 6e74 696f   Block as mentio
-00000360: 6e65 6420 696e 2031 3531 322e 3033 3338  ned in 1512.0338
-00000370: 3520 5b44 6565 7020 5265 7369 6475 616c  5 [Deep Residual
-00000380: 204c 6561 726e 696e 6720 666f 7220 496d   Learning for Im
-00000390: 6167 6520 5265 636f 676e 6974 696f 6e5d  age Recognition]
-000003a0: 0d0a 2020 2020 0d0a 2020 2020 426f 7474  ..    ..    Bott
-000003b0: 6c65 6e65 636b 2042 6c6f 636b 2056 3220  leneck Block V2 
-000003c0: 3a20 4d6f 6469 6669 6573 2052 6573 6964  : Modifies Resid
-000003d0: 7561 6c20 426c 6f63 6b73 2074 6f20 6861  ual Blocks to ha
-000003e0: 7665 206c 6172 6765 7220 6c65 6172 6e69  ve larger learni
-000003f0: 6e67 2063 6170 6163 6974 792c 2061 7320  ng capacity, as 
-00000400: 6d65 6e74 696f 6e65 6420 696e 2031 3831  mentioned in 181
-00000410: 322e 3031 3138 3720 5b42 6167 206f 6620  2.01187 [Bag of 
-00000420: 5472 6963 6b73 2066 6f72 2049 6d61 6765  Tricks for Image
-00000430: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
-00000440: 7769 7468 2043 6f6e 766f 6c75 7469 6f6e  with Convolution
-00000450: 616c 204e 6575 7261 6c20 4e65 7477 6f72  al Neural Networ
-00000460: 6b73 5d0d 0a0d 0a20 2020 204e 6578 7420  ks]....    Next 
-00000470: 426c 6f63 6b20 3a20 5265 706c 6163 6573  Block : Replaces
-00000480: 2043 6f6e 766f 6c75 7469 6f6e 7320 7769   Convolutions wi
-00000490: 7468 2047 726f 7570 6564 2043 6f6e 766f  th Grouped Convo
-000004a0: 6c75 7469 6f6e 7320 6173 2073 6565 2069  lutions as see i
-000004b0: 6e20 3136 3131 2e30 3534 3331 205b 4167  n 1611.05431 [Ag
-000004c0: 6772 6567 6174 6564 2052 6573 6964 7561  gregated Residua
-000004d0: 6c20 5472 616e 7366 6f72 6d61 7469 6f6e  l Transformation
-000004e0: 7320 666f 7220 4465 6570 204e 6575 7261  s for Deep Neura
-000004f0: 6c20 4e65 7477 6f72 6b73 5d0d 0a20 2020  l Networks]..   
-00000500: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
-00000510: 6465 7074 682c 2066 6c61 766f 7220 3d20  depth, flavor = 
-00000520: 6d6f 6469 6669 6572 730d 0a0d 0a20 2020  modifiers....   
-00000530: 2069 6620 666c 6176 6f72 203d 3d20 2776   if flavor == 'v
-00000540: 616e 696c 6c61 273a 0d0a 2020 2020 2020  anilla':..      
-00000550: 2020 7265 7475 726e 2056 616e 696c 6c61    return Vanilla
-00000560: 5f42 6c6f 636b 2864 6570 7468 2c20 7371  _Block(depth, sq
-00000570: 7565 657a 652c 2061 7567 6d65 6e74 2c20  ueeze, augment, 
-00000580: 6c61 7965 7229 0d0a 0d0a 2020 2020 656c  layer)....    el
-00000590: 6966 2066 6c61 766f 7220 3d3d 2027 626f  if flavor == 'bo
-000005a0: 7474 6c65 6e65 636b 273a 0d0a 2020 2020  ttleneck':..    
-000005b0: 2020 2020 7265 7475 726e 2042 6f74 746c      return Bottl
-000005c0: 656e 6563 6b5f 426c 6f63 6b28 6465 7074  eneck_Block(dept
-000005d0: 682c 2073 7175 6565 7a65 2c20 6175 676d  h, squeeze, augm
-000005e0: 656e 742c 206c 6179 6572 290d 0a0d 0a20  ent, layer).... 
-000005f0: 2020 2023 2065 6c69 6620 666c 6176 6f72     # elif flavor
-00000600: 203d 3d20 2763 7573 746f 6d27 3a0d 0a0d   == 'custom':...
-00000610: 0a20 2020 2023 2020 2020 2069 6620 6d6f  .    #     if mo
-00000620: 6469 6669 6572 735b 305d 2069 6e20 5b30  difiers[0] in [0
-00000630: 2c20 315d 3a0d 0a20 2020 2023 2020 2020  , 1]:..    #    
-00000640: 2020 2020 2072 6574 7572 6e20 5661 6e69       return Vani
-00000650: 6c6c 615f 426c 6f63 6b28 6d6f 6469 6669  lla_Block(modifi
-00000660: 6572 732c 2073 7175 6565 7a65 2c20 6175  ers, squeeze, au
-00000670: 676d 656e 742c 206c 6179 6572 2920 0d0a  gment, layer) ..
-00000680: 2020 2020 2320 2020 2020 656c 6966 206d      #     elif m
-00000690: 6f64 6966 6965 7273 5b30 5d20 696e 205b  odifiers[0] in [
-000006a0: 322c 2033 5d3a 0d0a 2020 2020 2320 2020  2, 3]:..    #   
-000006b0: 2020 2020 2020 7265 7475 726e 2042 6f74        return Bot
-000006c0: 746c 656e 6563 6b5f 426c 6f63 6b5f 5632  tleneck_Block_V2
-000006d0: 286d 6f64 6966 6965 7273 2c20 7371 7565  (modifiers, sque
-000006e0: 657a 652c 2061 7567 6d65 6e74 2c20 6c61  eze, augment, la
-000006f0: 7965 7229 0d0a 0d0a 0d0a 636c 6173 7320  yer)......class 
-00000700: 5661 6e69 6c6c 615f 426c 6f63 6b28 4d6f  Vanilla_Block(Mo
-00000710: 6475 6c65 293a 0d0a 2020 2020 6465 6620  dule):..    def 
-00000720: 5f5f 696e 6974 5f5f 2873 656c 662c 2020  __init__(self,  
-00000730: 6465 7074 682c 2073 7175 6565 7a65 2c20  depth, squeeze, 
-00000740: 6175 676d 656e 742c 206c 6179 6572 203d  augment, layer =
-00000750: 204e 6f6e 6529 3a0d 0a20 2020 2020 2020   None):..       
-00000760: 2073 7570 6572 2856 616e 696c 6c61 5f42   super(Vanilla_B
-00000770: 6c6f 636b 2c20 7365 6c66 292e 5f5f 696e  lock, self).__in
-00000780: 6974 5f5f 2829 0d0a 0d0a 2020 2020 2020  it__()....      
-00000790: 2020 6c61 7965 725f 6465 7074 6820 3d20    layer_depth = 
-000007a0: 6465 7074 680d 0a20 2020 2020 2020 2073  depth..        s
-000007b0: 656c 662e 6c61 7965 725f 6465 7074 6820  elf.layer_depth 
-000007c0: 3d20 6c61 7965 725f 6465 7074 680d 0a20  = layer_depth.. 
-000007d0: 2020 2020 2020 2073 656c 662e 7371 7565         self.sque
-000007e0: 657a 6520 3d20 7371 7565 657a 650d 0a20  eze = squeeze.. 
-000007f0: 2020 2020 2020 2073 656c 662e 6175 676d         self.augm
-00000800: 656e 7420 3d20 6175 676d 656e 740d 0a0d  ent = augment...
-00000810: 0a20 2020 2020 2020 2073 656c 662e 6c61  .        self.la
-00000820: 7965 7220 3d20 6c61 7965 720d 0a0d 0a20  yer = layer.... 
-00000830: 2020 2020 2020 2069 6620 6c61 7965 7220         if layer 
-00000840: 3d3d 2027 6669 7273 7427 3a0d 0a0d 0a20  == 'first':.... 
-00000850: 2020 2020 2020 2020 2020 2069 6620 6c61             if la
-00000860: 7965 725f 6465 7074 6820 3d3d 2030 3a0d  yer_depth == 0:.
-00000870: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00000880: 2020 2023 2069 5f63 6861 6e6e 656c 203d     # i_channel =
-00000890: 2036 340d 0a20 2020 2020 2020 2020 2020   64..           
-000008a0: 2020 2020 2023 206f 5f63 6861 6e6e 656c       # o_channel
-000008b0: 203d 2036 340d 0a0d 0a20 2020 2020 2020   = 64....       
-000008c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000008d0: 2020 2020 2020 2020 2020 2069 5f63 6861             i_cha
-000008e0: 6e6e 656c 203d 2031 360d 0a20 2020 2020  nnel = 16..     
-000008f0: 2020 2020 2020 2020 2020 206f 5f63 6861             o_cha
-00000900: 6e6e 656c 203d 2031 360d 0a0d 0a20 2020  nnel = 16....   
-00000910: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00000920: 6964 6520 3d20 310d 0a0d 0a20 2020 2020  ide = 1....     
-00000930: 2020 2020 2020 2065 6c73 653a 0d0a 0d0a         else:....
-00000940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000950: 2320 695f 6368 616e 6e65 6c20 3d20 3332  # i_channel = 32
-00000960: 202a 2028 3220 2a2a 206c 6179 6572 5f64   * (2 ** layer_d
-00000970: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
-00000980: 2020 2020 2020 2069 5f63 6861 6e6e 656c         i_channel
-00000990: 203d 2038 202a 2028 3220 2a2a 206c 6179   = 8 * (2 ** lay
-000009a0: 6572 5f64 6570 7468 290d 0a20 2020 2020  er_depth)..     
-000009b0: 2020 2020 2020 2020 2020 206f 5f63 6861             o_cha
-000009c0: 6e6e 656c 203d 2069 5f63 6861 6e6e 656c  nnel = i_channel
-000009d0: 202a 2032 0d0a 2020 2020 2020 2020 2020   * 2..          
-000009e0: 2020 2020 2020 7374 7269 6465 203d 2032        stride = 2
-000009f0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00000a00: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00000a10: 2069 5f63 6861 6e6e 656c 203d 2036 3420   i_channel = 64 
-00000a20: 2a20 2832 202a 2a20 6c61 7965 725f 6465  * (2 ** layer_de
-00000a30: 7074 6829 0d0a 2020 2020 2020 2020 2020  pth)..          
-00000a40: 2020 695f 6368 616e 6e65 6c20 3d20 3136    i_channel = 16
-00000a50: 202a 2028 3220 2a2a 206c 6179 6572 5f64   * (2 ** layer_d
-00000a60: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
-00000a70: 2020 206f 5f63 6861 6e6e 656c 203d 2069     o_channel = i
-00000a80: 5f63 6861 6e6e 656c 0d0a 2020 2020 2020  _channel..      
-00000a90: 2020 2020 2020 7374 7269 6465 203d 2031        stride = 1
-00000aa0: 0d0a 0d0a 0d0a 0d0a 2020 2020 2020 2020  ........        
-00000ab0: 7020 3d20 300d 0a20 2020 2020 2020 2062  p = 0..        b
-00000ac0: 6c6f 636b 5f73 697a 6520 3d20 3320 2b20  lock_size = 3 + 
-00000ad0: 286c 6179 6572 5f64 6570 7468 202a 2032  (layer_depth * 2
-00000ae0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00000af0: 7371 7565 657a 653a 0d0a 2020 2020 2020  squeeze:..      
-00000b00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00000b10: 2020 2020 7220 3d20 3136 0d0a 0d0a 2020      r = 16....  
-00000b20: 2020 2020 2020 2020 2020 7365 6c66 2e53            self.S
-00000b30: 4520 3d20 4d53 4341 4d28 6f5f 6368 616e  E = MSCAM(o_chan
-00000b40: 6e65 6c2c 2072 290d 0a20 2020 2020 2020  nel, r)..       
-00000b50: 2020 2020 2023 2073 656c 662e 5345 203d       # self.SE =
-00000b60: 2045 4341 2829 0d0a 2020 2020 2020 2020   ECA()..        
-00000b70: 2020 2020 7365 6c66 2e73 7061 7469 616c      self.spatial
-00000b80: 203d 2053 414d 2829 0d0a 0d0a 2020 2020   = SAM()....    
-00000b90: 2020 2020 6d6f 6d65 6e74 203d 2031 452d      moment = 1E-
-00000ba0: 310d 0a0d 0a20 2020 2020 2020 2073 656c  1....        sel
-00000bb0: 662e 7661 6e69 6c6c 615f 626c 6f63 6b20  f.vanilla_block 
-00000bc0: 3d20 5365 7175 656e 7469 616c 280d 0a20  = Sequential(.. 
-00000bd0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
-00000be0: 6f6e 7632 6428 696e 5f63 6861 6e6e 656c  onv2d(in_channel
-00000bf0: 7320 3d20 695f 6368 616e 6e65 6c2c 206f  s = i_channel, o
-00000c00: 7574 5f63 6861 6e6e 656c 7320 3d20 6f5f  ut_channels = o_
-00000c10: 6368 616e 6e65 6c2c 206b 6572 6e65 6c5f  channel, kernel_
-00000c20: 7369 7a65 203d 2033 2c20 7374 7269 6465  size = 3, stride
-00000c30: 203d 2031 2c20 7061 6464 696e 6720 3d20   = 1, padding = 
-00000c40: 312c 2062 6961 7320 3d20 4661 6c73 652c  1, bias = False,
-00000c50: 2067 726f 7570 7320 3d20 3229 2c0d 0a20   groups = 2),.. 
-00000c60: 2020 2020 2020 2020 2020 2020 2020 2042                 B
-00000c70: 6174 6368 4e6f 726d 3264 286f 5f63 6861  atchNorm2d(o_cha
-00000c80: 6e6e 656c 2c20 6d6f 6d65 6e74 756d 203d  nnel, momentum =
-00000c90: 206d 6f6d 656e 7429 2c0d 0a20 2020 2020   moment),..     
-00000ca0: 2020 2020 2020 2020 2020 2061 6374 692c             acti,
-00000cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000cc0: 2020 2320 4472 6f70 426c 6f63 6b32 6428    # DropBlock2d(
-00000cd0: 7020 3d20 302e 3235 2c20 626c 6f63 6b5f  p = 0.25, block_
-00000ce0: 7369 7a65 203d 2032 202a 2a20 2835 202d  size = 2 ** (5 -
-00000cf0: 206c 6179 6572 5f64 6570 7468 2929 2c0d   layer_depth)),.
-00000d00: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00000d10: 2020 2043 6f6e 7632 6428 696e 5f63 6861     Conv2d(in_cha
-00000d20: 6e6e 656c 7320 3d20 6f5f 6368 616e 6e65  nnels = o_channe
-00000d30: 6c2c 206f 7574 5f63 6861 6e6e 656c 7320  l, out_channels 
-00000d40: 3d20 6f5f 6368 616e 6e65 6c2c 206b 6572  = o_channel, ker
-00000d50: 6e65 6c5f 7369 7a65 203d 2033 2c20 7374  nel_size = 3, st
-00000d60: 7269 6465 203d 2073 7472 6964 652c 2070  ride = stride, p
-00000d70: 6164 6469 6e67 203d 2031 2c20 6269 6173  adding = 1, bias
-00000d80: 203d 2046 616c 7365 2c20 6772 6f75 7073   = False, groups
-00000d90: 203d 2032 292c 0d0a 2020 2020 2020 2020   = 2),..        
-00000da0: 2020 2020 2020 2020 4261 7463 684e 6f72          BatchNor
-00000db0: 6d32 6428 6f5f 6368 616e 6e65 6c2c 206d  m2d(o_channel, m
-00000dc0: 6f6d 656e 7475 6d20 3d20 6d6f 6d65 6e74  omentum = moment
-00000dd0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00000de0: 2020 2020 2320 4472 6f70 426c 6f63 6b32      # DropBlock2
-00000df0: 6428 7020 3d20 302e 3235 2c20 626c 6f63  d(p = 0.25, bloc
-00000e00: 6b5f 7369 7a65 203d 2032 202a 2a20 2835  k_size = 2 ** (5
-00000e10: 202d 206c 6179 6572 5f64 6570 7468 2929   - layer_depth))
-00000e20: 2c0d 0a20 2020 2020 2020 2020 2020 2029  ,..            )
-00000e30: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00000e40: 2020 2020 6966 206c 6179 6572 203d 3d20      if layer == 
-00000e50: 2766 6972 7374 2720 616e 6420 6c61 7965  'first' and laye
-00000e60: 725f 6465 7074 6820 213d 2030 3a20 0d0a  r_depth != 0: ..
-00000e70: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00000e80: 6c66 2e64 6f77 6e73 616d 706c 6520 3d20  lf.downsample = 
-00000e90: 5365 7175 656e 7469 616c 280d 0a20 2020  Sequential(..   
-00000ea0: 2020 2020 2020 2020 2020 2020 2041 7667               Avg
-00000eb0: 506f 6f6c 3264 286b 6572 6e65 6c5f 7369  Pool2d(kernel_si
-00000ec0: 7a65 203d 2073 7472 6964 652c 2073 7472  ze = stride, str
-00000ed0: 6964 6520 3d20 7374 7269 6465 292c 0d0a  ide = stride),..
-00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000f00: 2020 436f 6e76 3264 2869 6e5f 6368 616e    Conv2d(in_chan
-00000f10: 6e65 6c73 203d 2069 5f63 6861 6e6e 656c  nels = i_channel
-00000f20: 2c20 6f75 745f 6368 616e 6e65 6c73 203d  , out_channels =
-00000f30: 206f 5f63 6861 6e6e 656c 2c20 6b65 726e   o_channel, kern
-00000f40: 656c 5f73 697a 6520 3d20 312c 2073 7472  el_size = 1, str
-00000f50: 6964 6520 3d20 312c 2070 6164 6469 6e67  ide = 1, padding
-00000f60: 203d 2030 2c20 6269 6173 203d 2046 616c   = 0, bias = Fal
-00000f70: 7365 2c20 6772 6f75 7073 203d 2032 292c  se, groups = 2),
-00000f80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000f90: 2020 4261 7463 684e 6f72 6d32 6428 6f5f    BatchNorm2d(o_
-00000fa0: 6368 616e 6e65 6c2c 206d 6f6d 656e 7475  channel, momentu
-00000fb0: 6d20 3d20 6d6f 6d65 6e74 292c 0d0a 2020  m = moment),..  
-00000fc0: 2020 2020 2020 2020 2020 2020 2020 6163                ac
-00000fd0: 7469 2c0d 0a20 2020 2020 2020 2020 2020  ti,..           
-00000fe0: 2020 2020 2023 2044 726f 7042 6c6f 636b       # DropBlock
-00000ff0: 3264 2870 203d 2030 2e32 352c 2062 6c6f  2d(p = 0.25, blo
-00001000: 636b 5f73 697a 6520 3d20 3220 2a2a 2028  ck_size = 2 ** (
-00001010: 3520 2d20 6c61 7965 725f 6465 7074 6829  5 - layer_depth)
-00001020: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00001030: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
-00001040: 662e 6669 6e61 6c5f 6163 7469 203d 2061  f.final_acti = a
-00001050: 6374 690d 0a0d 0a20 2020 2064 6566 2066  cti....    def f
-00001060: 6f72 7761 7264 2873 656c 662c 2078 293a  orward(self, x):
-00001070: 0d0a 0d0a 2020 2020 2020 2020 6964 656e  ....        iden
-00001080: 7469 7479 203d 2078 0d0a 2020 2020 2020  tity = x..      
-00001090: 2020 7820 3d20 7365 6c66 2e76 616e 696c    x = self.vanil
-000010a0: 6c61 5f62 6c6f 636b 2878 290d 0a0d 0a20  la_block(x).... 
-000010b0: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-000010c0: 6179 6572 203d 3d20 2766 6972 7374 2720  ayer == 'first' 
-000010d0: 616e 6420 7365 6c66 2e6c 6179 6572 5f64  and self.layer_d
-000010e0: 6570 7468 2021 3d20 303a 0d0a 2020 2020  epth != 0:..    
-000010f0: 2020 2020 2020 2020 6964 656e 7469 7479          identity
-00001100: 203d 2073 656c 662e 646f 776e 7361 6d70   = self.downsamp
-00001110: 6c65 2869 6465 6e74 6974 7929 0d0a 0d0a  le(identity)....
-00001120: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001130: 7371 7565 657a 653a 2020 2020 0d0a 2020  squeeze:    ..  
-00001140: 2020 2020 2020 2020 2020 2320 7820 3d20            # x = 
-00001150: 7365 6c66 2e53 4528 6964 656e 7469 7479  self.SE(identity
-00001160: 2c20 7829 0d0a 2020 2020 2020 2020 2020  , x)..          
-00001170: 2020 7820 3d20 7365 6c66 2e53 4528 7829    x = self.SE(x)
-00001180: 0d0a 2020 2020 2020 2020 2020 2020 7820  ..            x 
-00001190: 3d20 7365 6c66 2e73 7061 7469 616c 2878  = self.spatial(x
-000011a0: 290d 0a0d 0a20 2020 2020 2020 2078 202b  )....        x +
-000011b0: 3d20 6964 656e 7469 7479 0d0a 2020 2020  = identity..    
-000011c0: 2020 2020 7820 3d20 7365 6c66 2e66 696e      x = self.fin
-000011d0: 616c 5f61 6374 6928 7829 0d0a 0d0a 2020  al_acti(x)....  
-000011e0: 2020 2020 2020 7265 7475 726e 2078 200d        return x .
-000011f0: 0a0d 0a0d 0a63 6c61 7373 2042 6f74 746c  .....class Bottl
-00001200: 656e 6563 6b5f 426c 6f63 6b28 4d6f 6475  eneck_Block(Modu
-00001210: 6c65 293a 0d0a 2020 2020 6465 6620 5f5f  le):..    def __
-00001220: 696e 6974 5f5f 2873 656c 662c 2020 6465  init__(self,  de
-00001230: 7074 682c 2073 7175 6565 7a65 2c20 6175  pth, squeeze, au
-00001240: 676d 656e 742c 206c 6179 6572 203d 204e  gment, layer = N
-00001250: 6f6e 6529 3a0d 0a20 2020 2020 2020 2073  one):..        s
-00001260: 7570 6572 2842 6f74 746c 656e 6563 6b5f  uper(Bottleneck_
-00001270: 426c 6f63 6b2c 2073 656c 6629 2e5f 5f69  Block, self).__i
-00001280: 6e69 745f 5f28 290d 0a0d 0a20 2020 2020  nit__()....     
-00001290: 2020 206c 6179 6572 5f64 6570 7468 203d     layer_depth =
-000012a0: 2064 6570 7468 0d0a 2020 2020 2020 2020   depth..        
-000012b0: 7365 6c66 2e6c 6179 6572 5f64 6570 7468  self.layer_depth
-000012c0: 203d 206c 6179 6572 5f64 6570 7468 0d0a   = layer_depth..
-000012d0: 2020 2020 2020 2020 7365 6c66 2e73 7175          self.squ
-000012e0: 6565 7a65 203d 2073 7175 6565 7a65 0d0a  eeze = squeeze..
-000012f0: 2020 2020 2020 2020 7365 6c66 2e61 7567          self.aug
-00001300: 6d65 6e74 203d 2061 7567 6d65 6e74 0d0a  ment = augment..
-00001310: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-00001320: 6179 6572 203d 206c 6179 6572 0d0a 0d0a  ayer = layer....
-00001330: 2020 2020 2020 2020 6966 206c 6179 6572          if layer
-00001340: 203d 3d20 2766 6972 7374 273a 0d0a 0d0a   == 'first':....
-00001350: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00001360: 6179 6572 5f64 6570 7468 203d 3d20 303a  ayer_depth == 0:
-00001370: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00001380: 2020 2020 695f 6368 616e 6e65 6c20 3d20      i_channel = 
-00001390: 3634 0d0a 2020 2020 2020 2020 2020 2020  64..            
-000013a0: 2020 2020 6d5f 6368 616e 6e65 6c20 3d20      m_channel = 
-000013b0: 695f 6368 616e 6e65 6c0d 0a20 2020 2020  i_channel..     
-000013c0: 2020 2020 2020 2020 2020 206f 5f63 6861             o_cha
-000013d0: 6e6e 656c 203d 2032 3536 0d0a 2020 2020  nnel = 256..    
-000013e0: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-000013f0: 6465 203d 2031 0d0a 0d0a 2020 2020 2020  de = 1....      
-00001400: 2020 2020 2020 656c 7365 3a0d 0a0d 0a20        else:.... 
-00001410: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00001420: 5f63 6861 6e6e 656c 203d 2031 3238 202a  _channel = 128 *
-00001430: 2028 3220 2a2a 206c 6179 6572 5f64 6570   (2 ** layer_dep
-00001440: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-00001450: 2020 2020 206d 5f63 6861 6e6e 656c 203d       m_channel =
-00001460: 2069 5f63 6861 6e6e 656c 202f 2f20 320d   i_channel // 2.
-00001470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001480: 206f 5f63 6861 6e6e 656c 203d 2069 5f63   o_channel = i_c
-00001490: 6861 6e6e 656c 202a 2032 0d0a 2020 2020  hannel * 2..    
-000014a0: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-000014b0: 6465 203d 2032 0d0a 0d0a 2020 2020 2020  de = 2....      
-000014c0: 2020 656c 7365 3a0d 0a0d 0a20 2020 2020    else:....     
-000014d0: 2020 2020 2020 2069 5f63 6861 6e6e 656c         i_channel
-000014e0: 203d 2032 3536 202a 2028 3220 2a2a 206c   = 256 * (2 ** l
-000014f0: 6179 6572 5f64 6570 7468 290d 0a20 2020  ayer_depth)..   
-00001500: 2020 2020 2020 2020 206d 5f63 6861 6e6e           m_chann
-00001510: 656c 203d 2069 5f63 6861 6e6e 656c 202f  el = i_channel /
-00001520: 2f20 340d 0a20 2020 2020 2020 2020 2020  / 4..           
-00001530: 206f 5f63 6861 6e6e 656c 203d 2069 5f63   o_channel = i_c
-00001540: 6861 6e6e 656c 0d0a 2020 2020 2020 2020  hannel..        
-00001550: 2020 2020 7374 7269 6465 203d 2031 0d0a      stride = 1..
-00001560: 0d0a 0d0a 2020 2020 2020 2020 7020 3d20  ....        p = 
-00001570: 300d 0a20 2020 2020 2020 2062 6c6f 636b  0..        block
-00001580: 5f73 697a 6520 3d20 3320 2b20 286c 6179  _size = 3 + (lay
-00001590: 6572 5f64 6570 7468 202a 2032 290d 0a0d  er_depth * 2)...
-000015a0: 0a20 2020 2020 2020 2069 6620 7371 7565  .        if sque
-000015b0: 657a 653a 0d0a 0d0a 2020 2020 2020 2020  eze:....        
-000015c0: 2020 2020 7220 3d20 3136 0d0a 0d0a 2020      r = 16....  
-000015d0: 2020 2020 2020 2020 2020 7365 6c66 2e53            self.S
-000015e0: 4520 3d20 5365 7175 656e 7469 616c 280d  E = Sequential(.
-000015f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001600: 204d 5343 414d 286f 5f63 6861 6e6e 656c   MSCAM(o_channel
-00001610: 2c20 7229 2c0d 0a20 2020 2020 2020 2020  , r),..         
-00001620: 2020 2020 2020 2053 414d 2829 2c0d 0a20         SAM(),.. 
-00001630: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00001640: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00001650: 2320 7365 6c66 2e53 4520 3d20 4146 4628  # self.SE = AFF(
-00001660: 6f5f 6368 616e 6e65 6c2c 2072 290d 0a0d  o_channel, r)...
-00001670: 0a20 2020 2020 2020 2073 656c 662e 626f  .        self.bo
-00001680: 7474 6c65 6e65 636b 5f62 6c6f 636b 203d  ttleneck_block =
-00001690: 2053 6571 7565 6e74 6961 6c28 0d0a 2020   Sequential(..  
-000016a0: 2020 2020 2020 2020 2020 2020 2020 436f                Co
-000016b0: 6e76 3264 2869 6e5f 6368 616e 6e65 6c73  nv2d(in_channels
-000016c0: 203d 2069 5f63 6861 6e6e 656c 2c20 6f75   = i_channel, ou
-000016d0: 745f 6368 616e 6e65 6c73 203d 206d 5f63  t_channels = m_c
-000016e0: 6861 6e6e 656c 2c20 6b65 726e 656c 5f73  hannel, kernel_s
-000016f0: 697a 6520 3d20 312c 2073 7472 6964 6520  ize = 1, stride 
-00001700: 3d20 312c 2070 6164 6469 6e67 203d 2030  = 1, padding = 0
-00001710: 2c20 6269 6173 203d 2046 616c 7365 292c  , bias = False),
-00001720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001730: 2020 4261 7463 684e 6f72 6d32 6428 6d5f    BatchNorm2d(m_
-00001740: 6368 616e 6e65 6c29 2c0d 0a20 2020 2020  channel),..     
-00001750: 2020 2020 2020 2020 2020 2061 6374 692c             acti,
-00001760: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00001770: 2020 2020 436f 6e76 3264 2869 6e5f 6368      Conv2d(in_ch
-00001780: 616e 6e65 6c73 203d 206d 5f63 6861 6e6e  annels = m_chann
-00001790: 656c 2c20 6f75 745f 6368 616e 6e65 6c73  el, out_channels
-000017a0: 203d 206d 5f63 6861 6e6e 656c 2c20 6b65   = m_channel, ke
-000017b0: 726e 656c 5f73 697a 6520 3d20 332c 2073  rnel_size = 3, s
-000017c0: 7472 6964 6520 3d20 7374 7269 6465 2c20  tride = stride, 
-000017d0: 7061 6464 696e 6720 3d20 312c 2062 6961  padding = 1, bia
-000017e0: 7320 3d20 4661 6c73 6529 2c0d 0a20 2020  s = False),..   
-000017f0: 2020 2020 2020 2020 2020 2020 2042 6174               Bat
-00001800: 6368 4e6f 726d 3264 286d 5f63 6861 6e6e  chNorm2d(m_chann
-00001810: 656c 292c 0d0a 2020 2020 2020 2020 2020  el),..          
-00001820: 2020 2020 2020 6163 7469 2c0d 0a0d 0a20        acti,.... 
-00001830: 2020 2020 2020 2020 2020 2020 2020 2043                 C
-00001840: 6f6e 7632 6428 696e 5f63 6861 6e6e 656c  onv2d(in_channel
-00001850: 7320 3d20 6d5f 6368 616e 6e65 6c2c 206f  s = m_channel, o
-00001860: 7574 5f63 6861 6e6e 656c 7320 3d20 6f5f  ut_channels = o_
-00001870: 6368 616e 6e65 6c2c 206b 6572 6e65 6c5f  channel, kernel_
-00001880: 7369 7a65 203d 2031 2c20 7374 7269 6465  size = 1, stride
-00001890: 203d 2031 2c20 7061 6464 696e 6720 3d20   = 1, padding = 
-000018a0: 302c 2062 6961 7320 3d20 4661 6c73 6529  0, bias = False)
-000018b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000018c0: 2020 2042 6174 6368 4e6f 726d 3264 286f     BatchNorm2d(o
-000018d0: 5f63 6861 6e6e 656c 292c 0d0a 2020 2020  _channel),..    
-000018e0: 2020 2020 2020 2020 2020 2020 2320 6163              # ac
-000018f0: 7469 2c0d 0a20 2020 2020 2020 2020 2020  ti,..           
-00001900: 2029 0d0a 0d0a 2020 2020 2020 2020 6966   )....        if
-00001910: 206c 6179 6572 203d 3d20 2766 6972 7374   layer == 'first
-00001920: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
-00001930: 2073 656c 662e 646f 776e 7361 6d70 6c65   self.downsample
-00001940: 203d 2053 6571 7565 6e74 6961 6c28 0d0a   = Sequential(..
-00001950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001960: 4176 6750 6f6f 6c32 6428 6b65 726e 656c  AvgPool2d(kernel
-00001970: 5f73 697a 6520 3d20 7374 7269 6465 2c20  _size = stride, 
-00001980: 7374 7269 6465 203d 2073 7472 6964 6529  stride = stride)
-00001990: 2c0d 0a0d 0a20 2020 2020 2020 2020 2020  ,....           
-000019a0: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
-000019b0: 6861 6e6e 656c 7320 3d20 695f 6368 616e  hannels = i_chan
-000019c0: 6e65 6c2c 206f 7574 5f63 6861 6e6e 656c  nel, out_channel
-000019d0: 7320 3d20 6f5f 6368 616e 6e65 6c2c 206b  s = o_channel, k
-000019e0: 6572 6e65 6c5f 7369 7a65 203d 2031 2c20  ernel_size = 1, 
-000019f0: 7374 7269 6465 203d 2031 2c20 7061 6464  stride = 1, padd
-00001a00: 696e 6720 3d20 302c 2062 6961 7320 3d20  ing = 0, bias = 
-00001a10: 4661 6c73 6529 2c0d 0a20 2020 2020 2020  False),..       
-00001a20: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
-00001a30: 726d 3264 286f 5f63 6861 6e6e 656c 292c  rm2d(o_channel),
-00001a40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001a50: 2020 6163 7469 2c0d 0a20 2020 2020 2020    acti,..       
-00001a60: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00001a70: 2020 7365 6c66 2e66 696e 616c 5f61 6374    self.final_act
-00001a80: 6920 3d20 6163 7469 0d0a 0d0a 2020 2020  i = acti....    
-00001a90: 6465 6620 666f 7277 6172 6428 7365 6c66  def forward(self
-00001aa0: 2c20 7829 3a0d 0a0d 0a20 2020 2020 2020  , x):....       
-00001ab0: 2069 6465 6e74 6974 7920 3d20 780d 0a0d   identity = x...
-00001ac0: 0a20 2020 2020 2020 2078 203d 2073 656c  .        x = sel
-00001ad0: 662e 626f 7474 6c65 6e65 636b 5f62 6c6f  f.bottleneck_blo
-00001ae0: 636b 2878 290d 0a0d 0a20 2020 2020 2020  ck(x)....       
-00001af0: 2069 6620 7365 6c66 2e6c 6179 6572 203d   if self.layer =
-00001b00: 3d20 2766 6972 7374 273a 0d0a 2020 2020  = 'first':..    
-00001b10: 2020 2020 2020 2020 6964 656e 7469 7479          identity
-00001b20: 203d 2073 656c 662e 646f 776e 7361 6d70   = self.downsamp
-00001b30: 6c65 2869 6465 6e74 6974 7929 0d0a 0d0a  le(identity)....
-00001b40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001b50: 7371 7565 657a 653a 2020 2020 0d0a 2020  squeeze:    ..  
-00001b60: 2020 2020 2020 2020 2020 7820 3d20 7365            x = se
-00001b70: 6c66 2e53 4528 782c 2069 6465 6e74 6974  lf.SE(x, identit
-00001b80: 7929 0d0a 0d0a 2020 2020 2020 2020 7820  y)....        x 
-00001b90: 3d20 7365 6c66 2e66 696e 616c 5f61 6374  = self.final_act
-00001ba0: 6928 7829 0d0a 0d0a 2020 2020 2020 2020  i(x)....        
-00001bb0: 7265 7475 726e 2078 0d0a 0d0a 0d0a 0d0a  return x........
-00001bc0: 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a            ............
+000001b0: 7263 680d 0a0d 0a66 726f 6d20 2e63 7573  rch....from .cus
+000001c0: 746f 6d5f 626c 6f63 6b73 2069 6d70 6f72  tom_blocks impor
+000001d0: 7420 4146 462c 4d53 4341 4d2c 2053 414d  t AFF,MSCAM, SAM
+000001e0: 2c20 6941 4646 2c20 4543 410d 0a0d 0a74  , iAFF, ECA....t
+000001f0: 6f72 6368 2e6d 616e 7561 6c5f 7365 6564  orch.manual_seed
+00000200: 2834 3329 0d0a 0d0a 6163 7469 203d 204d  (43)....acti = M
+00000210: 6973 6828 696e 706c 6163 6520 3d20 5472  ish(inplace = Tr
+00000220: 7565 290d 0a23 2061 6374 6920 3d20 5052  ue)..# acti = PR
+00000230: 654c 5528 290d 0a0d 0a23 2074 6f72 6368  eLU()....# torch
+00000240: 2e73 6574 5f66 6c6f 6174 3332 5f6d 6174  .set_float32_mat
+00000250: 6d75 6c5f 7072 6563 6973 696f 6e28 2268  mul_precision("h
+00000260: 6967 6822 290d 0a0d 0a64 6566 2052 6573  igh")....def Res
+00000270: 426c 6f63 6b28 6d6f 6469 6669 6572 732c  Block(modifiers,
+00000280: 2073 7175 6565 7a65 2c20 6175 676d 656e   squeeze, augmen
+00000290: 742c 206c 6179 6572 203d 204e 6f6e 6529  t, layer = None)
+000002a0: 3a0d 0a0d 0a20 2020 2022 2222 0d0a 2020  :....    """..  
+000002b0: 2020 5661 6e69 6c6c 6120 426c 6f63 6b20    Vanilla Block 
+000002c0: 3a20 4f72 6967 696e 616c 2052 6573 6964  : Original Resid
+000002d0: 7561 6c20 426c 6f63 6b20 6173 206d 656e  ual Block as men
+000002e0: 7469 6f6e 6564 2069 6e20 3135 3132 2e30  tioned in 1512.0
+000002f0: 3333 3835 205b 4465 6570 2052 6573 6964  3385 [Deep Resid
+00000300: 7561 6c20 4c65 6172 6e69 6e67 2066 6f72  ual Learning for
+00000310: 2049 6d61 6765 2052 6563 6f67 6e69 7469   Image Recogniti
+00000320: 6f6e 5d0d 0a0d 0a20 2020 2042 6f74 746c  on]....    Bottl
+00000330: 656e 6563 6b20 426c 6f63 6b20 3a20 4f72  eneck Block : Or
+00000340: 6967 696e 616c 2042 6f74 746c 656e 6563  iginal Bottlenec
+00000350: 6b20 426c 6f63 6b20 6173 206d 656e 7469  k Block as menti
+00000360: 6f6e 6564 2069 6e20 3135 3132 2e30 3333  oned in 1512.033
+00000370: 3835 205b 4465 6570 2052 6573 6964 7561  85 [Deep Residua
+00000380: 6c20 4c65 6172 6e69 6e67 2066 6f72 2049  l Learning for I
+00000390: 6d61 6765 2052 6563 6f67 6e69 7469 6f6e  mage Recognition
+000003a0: 5d0d 0a20 2020 200d 0a20 2020 2042 6f74  ]..    ..    Bot
+000003b0: 746c 656e 6563 6b20 426c 6f63 6b20 5632  tleneck Block V2
+000003c0: 203a 204d 6f64 6966 6965 7320 5265 7369   : Modifies Resi
+000003d0: 6475 616c 2042 6c6f 636b 7320 746f 2068  dual Blocks to h
+000003e0: 6176 6520 6c61 7267 6572 206c 6561 726e  ave larger learn
+000003f0: 696e 6720 6361 7061 6369 7479 2c20 6173  ing capacity, as
+00000400: 206d 656e 7469 6f6e 6564 2069 6e20 3138   mentioned in 18
+00000410: 3132 2e30 3131 3837 205b 4261 6720 6f66  12.01187 [Bag of
+00000420: 2054 7269 636b 7320 666f 7220 496d 6167   Tricks for Imag
+00000430: 6520 436c 6173 7369 6669 6361 7469 6f6e  e Classification
+00000440: 2077 6974 6820 436f 6e76 6f6c 7574 696f   with Convolutio
+00000450: 6e61 6c20 4e65 7572 616c 204e 6574 776f  nal Neural Netwo
+00000460: 726b 735d 0d0a 0d0a 2020 2020 4e65 7874  rks]....    Next
+00000470: 2042 6c6f 636b 203a 2052 6570 6c61 6365   Block : Replace
+00000480: 7320 436f 6e76 6f6c 7574 696f 6e73 2077  s Convolutions w
+00000490: 6974 6820 4772 6f75 7065 6420 436f 6e76  ith Grouped Conv
+000004a0: 6f6c 7574 696f 6e73 2061 7320 7365 6520  olutions as see 
+000004b0: 696e 2031 3631 312e 3035 3433 3120 5b41  in 1611.05431 [A
+000004c0: 6767 7265 6761 7465 6420 5265 7369 6475  ggregated Residu
+000004d0: 616c 2054 7261 6e73 666f 726d 6174 696f  al Transformatio
+000004e0: 6e73 2066 6f72 2044 6565 7020 4e65 7572  ns for Deep Neur
+000004f0: 616c 204e 6574 776f 726b 735d 0d0a 2020  al Networks]..  
+00000500: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
+00000510: 2064 6570 7468 2c20 666c 6176 6f72 203d   depth, flavor =
+00000520: 206d 6f64 6966 6965 7273 0d0a 0d0a 2020   modifiers....  
+00000530: 2020 6966 2066 6c61 766f 7220 3d3d 2027    if flavor == '
+00000540: 7661 6e69 6c6c 6127 3a0d 0a20 2020 2020  vanilla':..     
+00000550: 2020 2072 6574 7572 6e20 5661 6e69 6c6c     return Vanill
+00000560: 615f 426c 6f63 6b28 6465 7074 682c 2073  a_Block(depth, s
+00000570: 7175 6565 7a65 2c20 6175 676d 656e 742c  queeze, augment,
+00000580: 206c 6179 6572 290d 0a0d 0a20 2020 2065   layer)....    e
+00000590: 6c69 6620 666c 6176 6f72 203d 3d20 2762  lif flavor == 'b
+000005a0: 6f74 746c 656e 6563 6b27 3a0d 0a20 2020  ottleneck':..   
+000005b0: 2020 2020 2072 6574 7572 6e20 426f 7474       return Bott
+000005c0: 6c65 6e65 636b 5f42 6c6f 636b 2864 6570  leneck_Block(dep
+000005d0: 7468 2c20 7371 7565 657a 652c 2061 7567  th, squeeze, aug
+000005e0: 6d65 6e74 2c20 6c61 7965 7229 0d0a 0d0a  ment, layer)....
+000005f0: 2020 2020 2320 656c 6966 2066 6c61 766f      # elif flavo
+00000600: 7220 3d3d 2027 6375 7374 6f6d 273a 0d0a  r == 'custom':..
+00000610: 0d0a 2020 2020 2320 2020 2020 6966 206d  ..    #     if m
+00000620: 6f64 6966 6965 7273 5b30 5d20 696e 205b  odifiers[0] in [
+00000630: 302c 2031 5d3a 0d0a 2020 2020 2320 2020  0, 1]:..    #   
+00000640: 2020 2020 2020 7265 7475 726e 2056 616e        return Van
+00000650: 696c 6c61 5f42 6c6f 636b 286d 6f64 6966  illa_Block(modif
+00000660: 6965 7273 2c20 7371 7565 657a 652c 2061  iers, squeeze, a
+00000670: 7567 6d65 6e74 2c20 6c61 7965 7229 200d  ugment, layer) .
+00000680: 0a20 2020 2023 2020 2020 2065 6c69 6620  .    #     elif 
+00000690: 6d6f 6469 6669 6572 735b 305d 2069 6e20  modifiers[0] in 
+000006a0: 5b32 2c20 335d 3a0d 0a20 2020 2023 2020  [2, 3]:..    #  
+000006b0: 2020 2020 2020 2072 6574 7572 6e20 426f         return Bo
+000006c0: 7474 6c65 6e65 636b 5f42 6c6f 636b 5f56  ttleneck_Block_V
+000006d0: 3228 6d6f 6469 6669 6572 732c 2073 7175  2(modifiers, squ
+000006e0: 6565 7a65 2c20 6175 676d 656e 742c 206c  eeze, augment, l
+000006f0: 6179 6572 290d 0a0d 0a0d 0a63 6c61 7373  ayer)......class
+00000700: 2056 616e 696c 6c61 5f42 6c6f 636b 284d   Vanilla_Block(M
+00000710: 6f64 756c 6529 3a0d 0a20 2020 2064 6566  odule):..    def
+00000720: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00000730: 2064 6570 7468 2c20 7371 7565 657a 652c   depth, squeeze,
+00000740: 2061 7567 6d65 6e74 2c20 6c61 7965 7220   augment, layer 
+00000750: 3d20 4e6f 6e65 293a 0d0a 2020 2020 2020  = None):..      
+00000760: 2020 7375 7065 7228 5661 6e69 6c6c 615f    super(Vanilla_
+00000770: 426c 6f63 6b2c 2073 656c 6629 2e5f 5f69  Block, self).__i
+00000780: 6e69 745f 5f28 290d 0a0d 0a20 2020 2020  nit__()....     
+00000790: 2020 206c 6179 6572 5f64 6570 7468 203d     layer_depth =
+000007a0: 2064 6570 7468 0d0a 2020 2020 2020 2020   depth..        
+000007b0: 7365 6c66 2e6c 6179 6572 5f64 6570 7468  self.layer_depth
+000007c0: 203d 206c 6179 6572 5f64 6570 7468 0d0a   = layer_depth..
+000007d0: 2020 2020 2020 2020 7365 6c66 2e73 7175          self.squ
+000007e0: 6565 7a65 203d 2073 7175 6565 7a65 0d0a  eeze = squeeze..
+000007f0: 2020 2020 2020 2020 7365 6c66 2e61 7567          self.aug
+00000800: 6d65 6e74 203d 2061 7567 6d65 6e74 0d0a  ment = augment..
+00000810: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00000820: 6179 6572 203d 206c 6179 6572 0d0a 0d0a  ayer = layer....
+00000830: 2020 2020 2020 2020 6966 206c 6179 6572          if layer
+00000840: 203d 3d20 2766 6972 7374 273a 0d0a 0d0a   == 'first':....
+00000850: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00000860: 6179 6572 5f64 6570 7468 203d 3d20 303a  ayer_depth == 0:
+00000870: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00000880: 2020 2020 2320 695f 6368 616e 6e65 6c20      # i_channel 
+00000890: 3d20 3634 0d0a 2020 2020 2020 2020 2020  = 64..          
+000008a0: 2020 2020 2020 2320 6f5f 6368 616e 6e65        # o_channe
+000008b0: 6c20 3d20 3634 0d0a 0d0a 2020 2020 2020  l = 64....      
+000008c0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000008d0: 2020 2020 2020 2020 2020 2020 695f 6368              i_ch
+000008e0: 616e 6e65 6c20 3d20 3136 0d0a 2020 2020  annel = 16..    
+000008f0: 2020 2020 2020 2020 2020 2020 6f5f 6368              o_ch
+00000900: 616e 6e65 6c20 3d20 3136 0d0a 0d0a 2020  annel = 16....  
+00000910: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00000920: 7269 6465 203d 2031 0d0a 0d0a 2020 2020  ride = 1....    
+00000930: 2020 2020 2020 2020 656c 7365 3a0d 0a0d          else:...
+00000940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000950: 2023 2069 5f63 6861 6e6e 656c 203d 2033   # i_channel = 3
+00000960: 3220 2a20 2832 202a 2a20 6c61 7965 725f  2 * (2 ** layer_
+00000970: 6465 7074 6829 0d0a 2020 2020 2020 2020  depth)..        
+00000980: 2020 2020 2020 2020 695f 6368 616e 6e65          i_channe
+00000990: 6c20 3d20 3820 2a20 2832 202a 2a20 6c61  l = 8 * (2 ** la
+000009a0: 7965 725f 6465 7074 6829 0d0a 2020 2020  yer_depth)..    
+000009b0: 2020 2020 2020 2020 2020 2020 6f5f 6368              o_ch
+000009c0: 616e 6e65 6c20 3d20 695f 6368 616e 6e65  annel = i_channe
+000009d0: 6c20 2a20 320d 0a20 2020 2020 2020 2020  l * 2..         
+000009e0: 2020 2020 2020 2073 7472 6964 6520 3d20         stride = 
+000009f0: 320d 0a20 2020 2020 2020 2065 6c73 653a  2..        else:
+00000a00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00000a10: 2320 695f 6368 616e 6e65 6c20 3d20 3634  # i_channel = 64
+00000a20: 202a 2028 3220 2a2a 206c 6179 6572 5f64   * (2 ** layer_d
+00000a30: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
+00000a40: 2020 2069 5f63 6861 6e6e 656c 203d 2031     i_channel = 1
+00000a50: 3620 2a20 2832 202a 2a20 6c61 7965 725f  6 * (2 ** layer_
+00000a60: 6465 7074 6829 0d0a 2020 2020 2020 2020  depth)..        
+00000a70: 2020 2020 6f5f 6368 616e 6e65 6c20 3d20      o_channel = 
+00000a80: 695f 6368 616e 6e65 6c0d 0a20 2020 2020  i_channel..     
+00000a90: 2020 2020 2020 2073 7472 6964 6520 3d20         stride = 
+00000aa0: 310d 0a0d 0a0d 0a0d 0a20 2020 2020 2020  1........       
+00000ab0: 2070 203d 2030 0d0a 2020 2020 2020 2020   p = 0..        
+00000ac0: 626c 6f63 6b5f 7369 7a65 203d 2033 202b  block_size = 3 +
+00000ad0: 2028 6c61 7965 725f 6465 7074 6820 2a20   (layer_depth * 
+00000ae0: 3229 0d0a 0d0a 2020 2020 2020 2020 6966  2)....        if
+00000af0: 2073 7175 6565 7a65 3a0d 0a20 2020 2020   squeeze:..     
+00000b00: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00000b10: 2020 2020 2072 203d 2031 360d 0a0d 0a20       r = 16.... 
+00000b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000b30: 5345 203d 204d 5343 414d 286f 5f63 6861  SE = MSCAM(o_cha
+00000b40: 6e6e 656c 2c20 7229 0d0a 2020 2020 2020  nnel, r)..      
+00000b50: 2020 2020 2020 2320 7365 6c66 2e53 4520        # self.SE 
+00000b60: 3d20 4543 4128 290d 0a20 2020 2020 2020  = ECA()..       
+00000b70: 2020 2020 2073 656c 662e 7370 6174 6961       self.spatia
+00000b80: 6c20 3d20 5341 4d28 290d 0a0d 0a20 2020  l = SAM()....   
+00000b90: 2020 2020 206d 6f6d 656e 7420 3d20 3145       moment = 1E
+00000ba0: 2d31 0d0a 0d0a 2020 2020 2020 2020 7365  -1....        se
+00000bb0: 6c66 2e76 616e 696c 6c61 5f62 6c6f 636b  lf.vanilla_block
+00000bc0: 203d 2053 6571 7565 6e74 6961 6c28 0d0a   = Sequential(..
+00000bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000be0: 436f 6e76 3264 2869 6e5f 6368 616e 6e65  Conv2d(in_channe
+00000bf0: 6c73 203d 2069 5f63 6861 6e6e 656c 2c20  ls = i_channel, 
+00000c00: 6f75 745f 6368 616e 6e65 6c73 203d 206f  out_channels = o
+00000c10: 5f63 6861 6e6e 656c 2c20 6b65 726e 656c  _channel, kernel
+00000c20: 5f73 697a 6520 3d20 332c 2073 7472 6964  _size = 3, strid
+00000c30: 6520 3d20 312c 2070 6164 6469 6e67 203d  e = 1, padding =
+00000c40: 2031 2c20 6269 6173 203d 2046 616c 7365   1, bias = False
+00000c50: 2c20 6772 6f75 7073 203d 2032 292c 0d0a  , groups = 2),..
+00000c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c70: 4261 7463 684e 6f72 6d32 6428 6f5f 6368  BatchNorm2d(o_ch
+00000c80: 616e 6e65 6c2c 206d 6f6d 656e 7475 6d20  annel, momentum 
+00000c90: 3d20 6d6f 6d65 6e74 292c 0d0a 2020 2020  = moment),..    
+00000ca0: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+00000cb0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00000cc0: 2020 2023 2044 726f 7042 6c6f 636b 3264     # DropBlock2d
+00000cd0: 2870 203d 2030 2e32 352c 2062 6c6f 636b  (p = 0.25, block
+00000ce0: 5f73 697a 6520 3d20 3220 2a2a 2028 3520  _size = 2 ** (5 
+00000cf0: 2d20 6c61 7965 725f 6465 7074 6829 292c  - layer_depth)),
+00000d00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00000d10: 2020 2020 436f 6e76 3264 2869 6e5f 6368      Conv2d(in_ch
+00000d20: 616e 6e65 6c73 203d 206f 5f63 6861 6e6e  annels = o_chann
+00000d30: 656c 2c20 6f75 745f 6368 616e 6e65 6c73  el, out_channels
+00000d40: 203d 206f 5f63 6861 6e6e 656c 2c20 6b65   = o_channel, ke
+00000d50: 726e 656c 5f73 697a 6520 3d20 332c 2073  rnel_size = 3, s
+00000d60: 7472 6964 6520 3d20 7374 7269 6465 2c20  tride = stride, 
+00000d70: 7061 6464 696e 6720 3d20 312c 2062 6961  padding = 1, bia
+00000d80: 7320 3d20 4661 6c73 652c 2067 726f 7570  s = False, group
+00000d90: 7320 3d20 3229 2c0d 0a20 2020 2020 2020  s = 2),..       
+00000da0: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
+00000db0: 726d 3264 286f 5f63 6861 6e6e 656c 2c20  rm2d(o_channel, 
+00000dc0: 6d6f 6d65 6e74 756d 203d 206d 6f6d 656e  momentum = momen
+00000dd0: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
+00000de0: 2020 2020 2023 2044 726f 7042 6c6f 636b       # DropBlock
+00000df0: 3264 2870 203d 2030 2e32 352c 2062 6c6f  2d(p = 0.25, blo
+00000e00: 636b 5f73 697a 6520 3d20 3220 2a2a 2028  ck_size = 2 ** (
+00000e10: 3520 2d20 6c61 7965 725f 6465 7074 6829  5 - layer_depth)
+00000e20: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00000e30: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00000e40: 2020 2020 2069 6620 6c61 7965 7220 3d3d       if layer ==
+00000e50: 2027 6669 7273 7427 2061 6e64 206c 6179   'first' and lay
+00000e60: 6572 5f64 6570 7468 2021 3d20 303a 200d  er_depth != 0: .
+00000e70: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
+00000e80: 656c 662e 646f 776e 7361 6d70 6c65 203d  elf.downsample =
+00000e90: 2053 6571 7565 6e74 6961 6c28 0d0a 2020   Sequential(..  
+00000ea0: 2020 2020 2020 2020 2020 2020 2020 4176                Av
+00000eb0: 6750 6f6f 6c32 6428 6b65 726e 656c 5f73  gPool2d(kernel_s
+00000ec0: 697a 6520 3d20 7374 7269 6465 2c20 7374  ize = stride, st
+00000ed0: 7269 6465 203d 2073 7472 6964 6529 2c0d  ride = stride),.
+00000ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000ef0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00000f00: 2020 2043 6f6e 7632 6428 696e 5f63 6861     Conv2d(in_cha
+00000f10: 6e6e 656c 7320 3d20 695f 6368 616e 6e65  nnels = i_channe
+00000f20: 6c2c 206f 7574 5f63 6861 6e6e 656c 7320  l, out_channels 
+00000f30: 3d20 6f5f 6368 616e 6e65 6c2c 206b 6572  = o_channel, ker
+00000f40: 6e65 6c5f 7369 7a65 203d 2031 2c20 7374  nel_size = 1, st
+00000f50: 7269 6465 203d 2031 2c20 7061 6464 696e  ride = 1, paddin
+00000f60: 6720 3d20 302c 2062 6961 7320 3d20 4661  g = 0, bias = Fa
+00000f70: 6c73 652c 2067 726f 7570 7320 3d20 3229  lse, groups = 2)
+00000f80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00000f90: 2020 2042 6174 6368 4e6f 726d 3264 286f     BatchNorm2d(o
+00000fa0: 5f63 6861 6e6e 656c 2c20 6d6f 6d65 6e74  _channel, moment
+00000fb0: 756d 203d 206d 6f6d 656e 7429 2c0d 0a20  um = moment),.. 
+00000fc0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00000fd0: 6374 692c 0d0a 2020 2020 2020 2020 2020  cti,..          
+00000fe0: 2020 2020 2020 2320 4472 6f70 426c 6f63        # DropBloc
+00000ff0: 6b32 6428 7020 3d20 302e 3235 2c20 626c  k2d(p = 0.25, bl
+00001000: 6f63 6b5f 7369 7a65 203d 2032 202a 2a20  ock_size = 2 ** 
+00001010: 2835 202d 206c 6179 6572 5f64 6570 7468  (5 - layer_depth
+00001020: 2929 2c0d 0a20 2020 2020 2020 2020 2020  )),..           
+00001030: 2029 0d0a 0d0a 2020 2020 2020 2020 7365   )....        se
+00001040: 6c66 2e66 696e 616c 5f61 6374 6920 3d20  lf.final_acti = 
+00001050: 6163 7469 0d0a 0d0a 2020 2020 6465 6620  acti....    def 
+00001060: 666f 7277 6172 6428 7365 6c66 2c20 7829  forward(self, x)
+00001070: 3a0d 0a0d 0a20 2020 2020 2020 2069 6465  :....        ide
+00001080: 6e74 6974 7920 3d20 780d 0a20 2020 2020  ntity = x..     
+00001090: 2020 2078 203d 2073 656c 662e 7661 6e69     x = self.vani
+000010a0: 6c6c 615f 626c 6f63 6b28 7829 0d0a 0d0a  lla_block(x)....
+000010b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000010c0: 6c61 7965 7220 3d3d 2027 6669 7273 7427  layer == 'first'
+000010d0: 2061 6e64 2073 656c 662e 6c61 7965 725f   and self.layer_
+000010e0: 6465 7074 6820 213d 2030 3a0d 0a20 2020  depth != 0:..   
+000010f0: 2020 2020 2020 2020 2069 6465 6e74 6974           identit
+00001100: 7920 3d20 7365 6c66 2e64 6f77 6e73 616d  y = self.downsam
+00001110: 706c 6528 6964 656e 7469 7479 290d 0a0d  ple(identity)...
+00001120: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00001130: 2e73 7175 6565 7a65 3a20 2020 200d 0a20  .squeeze:    .. 
+00001140: 2020 2020 2020 2020 2020 2023 2078 203d             # x =
+00001150: 2073 656c 662e 5345 2869 6465 6e74 6974   self.SE(identit
+00001160: 792c 2078 290d 0a20 2020 2020 2020 2020  y, x)..         
+00001170: 2020 2078 203d 2073 656c 662e 5345 2878     x = self.SE(x
+00001180: 290d 0a20 2020 2020 2020 2020 2020 2078  )..            x
+00001190: 203d 2073 656c 662e 7370 6174 6961 6c28   = self.spatial(
+000011a0: 7829 0d0a 0d0a 2020 2020 2020 2020 7820  x)....        x 
+000011b0: 2b3d 2069 6465 6e74 6974 790d 0a20 2020  += identity..   
+000011c0: 2020 2020 2078 203d 2073 656c 662e 6669       x = self.fi
+000011d0: 6e61 6c5f 6163 7469 2878 290d 0a0d 0a20  nal_acti(x).... 
+000011e0: 2020 2020 2020 2072 6574 7572 6e20 7820         return x 
+000011f0: 0d0a 0d0a 0d0a 636c 6173 7320 426f 7474  ......class Bott
+00001200: 6c65 6e65 636b 5f42 6c6f 636b 284d 6f64  leneck_Block(Mod
+00001210: 756c 6529 3a0d 0a20 2020 2064 6566 205f  ule):..    def _
+00001220: 5f69 6e69 745f 5f28 7365 6c66 2c20 2064  _init__(self,  d
+00001230: 6570 7468 2c20 7371 7565 657a 652c 2061  epth, squeeze, a
+00001240: 7567 6d65 6e74 2c20 6c61 7965 7220 3d20  ugment, layer = 
+00001250: 4e6f 6e65 293a 0d0a 2020 2020 2020 2020  None):..        
+00001260: 7375 7065 7228 426f 7474 6c65 6e65 636b  super(Bottleneck
+00001270: 5f42 6c6f 636b 2c20 7365 6c66 292e 5f5f  _Block, self).__
+00001280: 696e 6974 5f5f 2829 0d0a 0d0a 2020 2020  init__()....    
+00001290: 2020 2020 6c61 7965 725f 6465 7074 6820      layer_depth 
+000012a0: 3d20 6465 7074 680d 0a20 2020 2020 2020  = depth..       
+000012b0: 2073 656c 662e 6c61 7965 725f 6465 7074   self.layer_dept
+000012c0: 6820 3d20 6c61 7965 725f 6465 7074 680d  h = layer_depth.
+000012d0: 0a20 2020 2020 2020 2073 656c 662e 7371  .        self.sq
+000012e0: 7565 657a 6520 3d20 7371 7565 657a 650d  ueeze = squeeze.
+000012f0: 0a20 2020 2020 2020 2073 656c 662e 6175  .        self.au
+00001300: 676d 656e 7420 3d20 6175 676d 656e 740d  gment = augment.
+00001310: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00001320: 6c61 7965 7220 3d20 6c61 7965 720d 0a0d  layer = layer...
+00001330: 0a20 2020 2020 2020 2069 6620 6c61 7965  .        if laye
+00001340: 7220 3d3d 2027 6669 7273 7427 3a0d 0a0d  r == 'first':...
+00001350: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00001360: 6c61 7965 725f 6465 7074 6820 3d3d 2030  layer_depth == 0
+00001370: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00001380: 2020 2020 2069 5f63 6861 6e6e 656c 203d       i_channel =
+00001390: 2036 340d 0a20 2020 2020 2020 2020 2020   64..           
+000013a0: 2020 2020 206d 5f63 6861 6e6e 656c 203d       m_channel =
+000013b0: 2069 5f63 6861 6e6e 656c 0d0a 2020 2020   i_channel..    
+000013c0: 2020 2020 2020 2020 2020 2020 6f5f 6368              o_ch
+000013d0: 616e 6e65 6c20 3d20 3235 360d 0a20 2020  annel = 256..   
+000013e0: 2020 2020 2020 2020 2020 2020 2073 7472               str
+000013f0: 6964 6520 3d20 310d 0a0d 0a20 2020 2020  ide = 1....     
+00001400: 2020 2020 2020 2065 6c73 653a 0d0a 0d0a         else:....
+00001410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001420: 695f 6368 616e 6e65 6c20 3d20 3132 3820  i_channel = 128 
+00001430: 2a20 2832 202a 2a20 6c61 7965 725f 6465  * (2 ** layer_de
+00001440: 7074 6829 0d0a 2020 2020 2020 2020 2020  pth)..          
+00001450: 2020 2020 2020 6d5f 6368 616e 6e65 6c20        m_channel 
+00001460: 3d20 695f 6368 616e 6e65 6c20 2f2f 2032  = i_channel // 2
+00001470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001480: 2020 6f5f 6368 616e 6e65 6c20 3d20 695f    o_channel = i_
+00001490: 6368 616e 6e65 6c20 2a20 320d 0a20 2020  channel * 2..   
+000014a0: 2020 2020 2020 2020 2020 2020 2073 7472               str
+000014b0: 6964 6520 3d20 320d 0a0d 0a20 2020 2020  ide = 2....     
+000014c0: 2020 2065 6c73 653a 0d0a 0d0a 2020 2020     else:....    
+000014d0: 2020 2020 2020 2020 695f 6368 616e 6e65          i_channe
+000014e0: 6c20 3d20 3235 3620 2a20 2832 202a 2a20  l = 256 * (2 ** 
+000014f0: 6c61 7965 725f 6465 7074 6829 0d0a 2020  layer_depth)..  
+00001500: 2020 2020 2020 2020 2020 6d5f 6368 616e            m_chan
+00001510: 6e65 6c20 3d20 695f 6368 616e 6e65 6c20  nel = i_channel 
+00001520: 2f2f 2034 0d0a 2020 2020 2020 2020 2020  // 4..          
+00001530: 2020 6f5f 6368 616e 6e65 6c20 3d20 695f    o_channel = i_
+00001540: 6368 616e 6e65 6c0d 0a20 2020 2020 2020  channel..       
+00001550: 2020 2020 2073 7472 6964 6520 3d20 310d       stride = 1.
+00001560: 0a0d 0a0d 0a20 2020 2020 2020 2070 203d  .....        p =
+00001570: 2030 0d0a 2020 2020 2020 2020 626c 6f63   0..        bloc
+00001580: 6b5f 7369 7a65 203d 2033 202b 2028 6c61  k_size = 3 + (la
+00001590: 7965 725f 6465 7074 6820 2a20 3229 0d0a  yer_depth * 2)..
+000015a0: 0d0a 2020 2020 2020 2020 6966 2073 7175  ..        if squ
+000015b0: 6565 7a65 3a0d 0a0d 0a20 2020 2020 2020  eeze:....       
+000015c0: 2020 2020 2072 203d 2031 360d 0a0d 0a20       r = 16.... 
+000015d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000015e0: 5345 203d 2053 6571 7565 6e74 6961 6c28  SE = Sequential(
+000015f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001600: 2020 4d53 4341 4d28 6f5f 6368 616e 6e65    MSCAM(o_channe
+00001610: 6c2c 2072 292c 0d0a 2020 2020 2020 2020  l, r),..        
+00001620: 2020 2020 2020 2020 5341 4d28 292c 0d0a          SAM(),..
+00001630: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00001640: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00001650: 2023 2073 656c 662e 5345 203d 2041 4646   # self.SE = AFF
+00001660: 286f 5f63 6861 6e6e 656c 2c20 7229 0d0a  (o_channel, r)..
+00001670: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
+00001680: 6f74 746c 656e 6563 6b5f 626c 6f63 6b20  ottleneck_block 
+00001690: 3d20 5365 7175 656e 7469 616c 280d 0a20  = Sequential(.. 
+000016a0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+000016b0: 6f6e 7632 6428 696e 5f63 6861 6e6e 656c  onv2d(in_channel
+000016c0: 7320 3d20 695f 6368 616e 6e65 6c2c 206f  s = i_channel, o
+000016d0: 7574 5f63 6861 6e6e 656c 7320 3d20 6d5f  ut_channels = m_
+000016e0: 6368 616e 6e65 6c2c 206b 6572 6e65 6c5f  channel, kernel_
+000016f0: 7369 7a65 203d 2031 2c20 7374 7269 6465  size = 1, stride
+00001700: 203d 2031 2c20 7061 6464 696e 6720 3d20   = 1, padding = 
+00001710: 302c 2062 6961 7320 3d20 4661 6c73 6529  0, bias = False)
+00001720: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001730: 2020 2042 6174 6368 4e6f 726d 3264 286d     BatchNorm2d(m
+00001740: 5f63 6861 6e6e 656c 292c 0d0a 2020 2020  _channel),..    
+00001750: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+00001760: 2c0d 0a0d 0a20 2020 2020 2020 2020 2020  ,....           
+00001770: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
+00001780: 6861 6e6e 656c 7320 3d20 6d5f 6368 616e  hannels = m_chan
+00001790: 6e65 6c2c 206f 7574 5f63 6861 6e6e 656c  nel, out_channel
+000017a0: 7320 3d20 6d5f 6368 616e 6e65 6c2c 206b  s = m_channel, k
+000017b0: 6572 6e65 6c5f 7369 7a65 203d 2033 2c20  ernel_size = 3, 
+000017c0: 7374 7269 6465 203d 2073 7472 6964 652c  stride = stride,
+000017d0: 2070 6164 6469 6e67 203d 2031 2c20 6269   padding = 1, bi
+000017e0: 6173 203d 2046 616c 7365 292c 0d0a 2020  as = False),..  
+000017f0: 2020 2020 2020 2020 2020 2020 2020 4261                Ba
+00001800: 7463 684e 6f72 6d32 6428 6d5f 6368 616e  tchNorm2d(m_chan
+00001810: 6e65 6c29 2c0d 0a20 2020 2020 2020 2020  nel),..         
+00001820: 2020 2020 2020 2061 6374 692c 0d0a 0d0a         acti,....
+00001830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001840: 436f 6e76 3264 2869 6e5f 6368 616e 6e65  Conv2d(in_channe
+00001850: 6c73 203d 206d 5f63 6861 6e6e 656c 2c20  ls = m_channel, 
+00001860: 6f75 745f 6368 616e 6e65 6c73 203d 206f  out_channels = o
+00001870: 5f63 6861 6e6e 656c 2c20 6b65 726e 656c  _channel, kernel
+00001880: 5f73 697a 6520 3d20 312c 2073 7472 6964  _size = 1, strid
+00001890: 6520 3d20 312c 2070 6164 6469 6e67 203d  e = 1, padding =
+000018a0: 2030 2c20 6269 6173 203d 2046 616c 7365   0, bias = False
+000018b0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+000018c0: 2020 2020 4261 7463 684e 6f72 6d32 6428      BatchNorm2d(
+000018d0: 6f5f 6368 616e 6e65 6c29 2c0d 0a20 2020  o_channel),..   
+000018e0: 2020 2020 2020 2020 2020 2020 2023 2061               # a
+000018f0: 6374 692c 0d0a 2020 2020 2020 2020 2020  cti,..          
+00001900: 2020 290d 0a0d 0a20 2020 2020 2020 2069    )....        i
+00001910: 6620 6c61 7965 7220 3d3d 2027 6669 7273  f layer == 'firs
+00001920: 7427 3a20 0d0a 2020 2020 2020 2020 2020  t': ..          
+00001930: 2020 7365 6c66 2e64 6f77 6e73 616d 706c    self.downsampl
+00001940: 6520 3d20 5365 7175 656e 7469 616c 280d  e = Sequential(.
+00001950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001960: 2041 7667 506f 6f6c 3264 286b 6572 6e65   AvgPool2d(kerne
+00001970: 6c5f 7369 7a65 203d 2073 7472 6964 652c  l_size = stride,
+00001980: 2073 7472 6964 6520 3d20 7374 7269 6465   stride = stride
+00001990: 292c 0d0a 0d0a 2020 2020 2020 2020 2020  ),....          
+000019a0: 2020 2020 2020 436f 6e76 3264 2869 6e5f        Conv2d(in_
+000019b0: 6368 616e 6e65 6c73 203d 2069 5f63 6861  channels = i_cha
+000019c0: 6e6e 656c 2c20 6f75 745f 6368 616e 6e65  nnel, out_channe
+000019d0: 6c73 203d 206f 5f63 6861 6e6e 656c 2c20  ls = o_channel, 
+000019e0: 6b65 726e 656c 5f73 697a 6520 3d20 312c  kernel_size = 1,
+000019f0: 2073 7472 6964 6520 3d20 312c 2070 6164   stride = 1, pad
+00001a00: 6469 6e67 203d 2030 2c20 6269 6173 203d  ding = 0, bias =
+00001a10: 2046 616c 7365 292c 0d0a 2020 2020 2020   False),..      
+00001a20: 2020 2020 2020 2020 2020 4261 7463 684e            BatchN
+00001a30: 6f72 6d32 6428 6f5f 6368 616e 6e65 6c29  orm2d(o_channel)
+00001a40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001a50: 2020 2061 6374 692c 0d0a 2020 2020 2020     acti,..      
+00001a60: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00001a70: 2020 2073 656c 662e 6669 6e61 6c5f 6163     self.final_ac
+00001a80: 7469 203d 2061 6374 690d 0a0d 0a20 2020  ti = acti....   
+00001a90: 2064 6566 2066 6f72 7761 7264 2873 656c   def forward(sel
+00001aa0: 662c 2078 293a 0d0a 0d0a 2020 2020 2020  f, x):....      
+00001ab0: 2020 6964 656e 7469 7479 203d 2078 0d0a    identity = x..
+00001ac0: 0d0a 2020 2020 2020 2020 7820 3d20 7365  ..        x = se
+00001ad0: 6c66 2e62 6f74 746c 656e 6563 6b5f 626c  lf.bottleneck_bl
+00001ae0: 6f63 6b28 7829 0d0a 0d0a 2020 2020 2020  ock(x)....      
+00001af0: 2020 6966 2073 656c 662e 6c61 7965 7220    if self.layer 
+00001b00: 3d3d 2027 6669 7273 7427 3a0d 0a20 2020  == 'first':..   
+00001b10: 2020 2020 2020 2020 2069 6465 6e74 6974           identit
+00001b20: 7920 3d20 7365 6c66 2e64 6f77 6e73 616d  y = self.downsam
+00001b30: 706c 6528 6964 656e 7469 7479 290d 0a0d  ple(identity)...
+00001b40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00001b50: 2e73 7175 6565 7a65 3a20 2020 200d 0a20  .squeeze:    .. 
+00001b60: 2020 2020 2020 2020 2020 2078 203d 2073             x = s
+00001b70: 656c 662e 5345 2878 2c20 6964 656e 7469  elf.SE(x, identi
+00001b80: 7479 290d 0a0d 0a20 2020 2020 2020 2078  ty)....        x
+00001b90: 203d 2073 656c 662e 6669 6e61 6c5f 6163   = self.final_ac
+00001ba0: 7469 2878 290d 0a0d 0a20 2020 2020 2020  ti(x)....       
+00001bb0: 2072 6574 7572 6e20 780d 0a0d 0a0d 0a0d   return x.......
+00001bc0: 0a0d 0a0d 0a0d 0a0d 0a0d 0a0d 0a         .............
```

### Comparing `dep_lerng-0.16/dep_lerng/ResNet.py` & `dep_lerng-0.17/dep_lerng/ResNet.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.16/dep_lerng/custom_blocks.py` & `dep_lerng-0.17/dep_lerng/custom_blocks.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.16/dep_lerng/model_init.py` & `dep_lerng-0.17/dep_lerng/model_init.py`

 * *Files identical despite different names*

